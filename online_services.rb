require 'faraday'
require './online_services_middleware.rb'

class OnlineServices

  def initialize(data, config, logger)
    @data = data
    @config = config
    @logger = logger

    @conn = Faraday.new(:url => 'https://onlineservices.immigration.govt.nz', :ssl => { verify: false }) do |faraday|
      faraday.request  :url_encoded
      faraday.response :logger, @logger, { :bodies => false }

      faraday.use OnlineServicesMiddleware
      faraday.adapter  Faraday.default_adapter
    end
  end

  def send_request(form)
    @logger.info("Start(online_services): " + form)
    value = send form
    @logger.info("Finish(online_services): " + form)

    value
  rescue Faraday::ClientError => e
    @logger.error(e)
    Rollbar.error(e)

    retry
  end

  private
  def login
    res = @conn.post do |req|
      req.url '/Templates/Secure/Login.aspx?NRMODE=Published&NRNODEGUID=%7b4DE5075C-B9EE-4A38-BA45-C24832C3DBEC%7d&NRORIGINALURL=%2fsecure%2fLogin%2bWorking%2bHoliday%2ehtm&NRCACHEHINT=Guest'

      req.body   = {
        "__EVENTTARGET"                                                  => "ctl00$ContentPlaceHolder1$medicalConditions$renalDialysisDropDownList",
        "__EVENTARGUMENT"                                                => "",
        "__VIEWSTATE"                                                    => "dDwxMDA1ODA0MzMwO3Q8O2w8aTwwPjtpPDE+Oz47bDx0PDtsPGk8Mz47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47Pj47dDw7bDxpPDA+O2k8Mj47aTw0PjtpPDg+O2k8MTI+O2k8MTQ+O2k8MTY+O2k8MjA+Oz47bDx0PDtsPGk8MD47aTwyPjtpPDM+Oz47bDx0PHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+O2w8aTwxPjs+O2w8dDw7bDxpPDE+O2k8Mz47aTw1PjtpPDc+O2k8OT47aTwxMT47PjtsPHQ8cDxsPFRleHQ7PjtsPCAtIDs+Pjs7Pjt0PHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+Ozs+O3Q8O2w8aTwxPjs+O2w8dDxwPGw8dGl0bGU7b25jbGljaztpbm5lcmh0bWw7PjtsPExpbmsgb3BlbnMgaW4gYSBuZXcgd2luZG93O3dpbmRvdy5vcGVuKCcvcmVnaXN0cmF0aW9uL21hbmFnZXN1aXRjYXNlLmFzcHgnLCdtYW5hZ2VzdWl0Y2FzZXBvcHVwJywndG9vbGJhcj1ubyxsb2NhdGlvbj1ubyxzdGF0dXM9eWVzLG1lbnViYXI9bm8sc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx3aWR0aD04NDAsaGVpZ2h0PTUyMCcpXDsgcmV0dXJuIGZhbHNlO01hbmFnZSBGYXZvdXJpdGVzOz4+Ozs+Oz4+O3Q8O2w8aTwxPjs+O2w8dDxwPGw8dGl0bGU7b25jbGljaztpbm5lcmh0bWw7PjtsPExpbmsgb3BlbnMgaW4gYSBuZXcgd2luZG93O3dpbmRvdy5vcGVuKCcvcmVnaXN0cmF0aW9uL3doYXRzaGFwcGVuaW5nLmFzcHgnLCd3aGF0c2hhcHBlbmluZ3BvcHVwJywndG9vbGJhcj1ubyxsb2NhdGlvbj1ubyxzdGF0dXM9eWVzLG1lbnViYXI9bm8sc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx3aWR0aD04NDAsaGVpZ2h0PTUyMCcpXDsgcmV0dXJuIGZhbHNlO015IEFwcGxpY2F0aW9uOz4+Ozs+Oz4+O3Q8cDxsPGhyZWY7PjtsPC9SZWdpc3RyYXRpb24vTG9nT3V0LmFzcHg7Pj47Oz47dDxwPGw8VGV4dDs+O2w8XDxhIGhyZWY9Imh0dHA6Ly93d3cuaW1taWdyYXRpb24uZ292dC5uei9taWdyYW50L2dlbmVyYWwvYWJvdXRuemlzL2NvbnRhY3R1cy9kZWZhdWx0Lmh0bSJcPkNvbnRhY3QgVXNcPC9hXD47Pj47Oz47Pj47Pj47dDw7bDxpPDA+Oz47bDx0PHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+Ozs+Oz4+O3Q8O2w8aTwwPjs+O2w8dDxwPGw8VGV4dDs+O2w8XDxhIGhyZWY9Ii8iXD5Ib21lXDwvYVw+ICZndFw7IFw8YSBocmVmPSIvc2VjdXJlLyJcPkxvZ2luXDwvYVw+Oz4+Ozs+Oz4+Oz4+O3Q8O2w8aTwwPjs+O2w8dDxwPGw8VmlzaWJsZTs+O2w8bzxmPjs+Pjs7Pjs+Pjt0PDtsPGk8MD47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47Pj47dDx0PHA8bDxEYXRhVGV4dEZpZWxkO0RhdGFWYWx1ZUZpZWxkOz47bDxLZXk7VmFsdWU7Pj47dDxpPDQ+O0A8Q2hlY2sgdGhlIHN0YXR1cyBvZiB5b3VyIGFwcGxpY2F0aW9uO1NraWxsZWQgTWlncmFudCAtIGV4cHJlc3Npb24gb2YgaW50ZXJlc3Q7U2lsdmVyIEZlcm4gSm9iIFNlYXJjaCB2aXNhO1dvcmtpbmcgSG9saWRheSB2aXNhOz47QDwvc2VjdXJlL3N0YXR1cy5odG07L3NlY3VyZS9Mb2dpbitTa2lsbGVkK01pZ3JhbnQuaHRtOy9zZWN1cmUvTG9naW4rU2lsdmVyK0Zlcm4uaHRtOy9zZWN1cmUvTG9naW4rV29ya2luZytIb2xpZGF5Lmh0bTs+Pjs+Ozs+O3Q8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47bDxpPDE+Oz47bDx0PDtsPGk8MD47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47bDxpPDE+Oz47bDx0PHA8cDxsPFRleHQ7PjtsPFNlbGVjdCB3aGljaCB0eXBlIG9mIGxvZ2luIHRvIGRpc3BsYXksIGlmIGFueTs+Pjs+Ozs+Oz4+Oz4+Oz4+O3Q8O2w8aTwxPjs+O2w8dDw7bDxpPDA+Oz47bDx0PDtsPGk8MT47aTwzPjtpPDU+O2k8OT47aTwxMT47aTwxMz47PjtsPHQ8cDxsPG9uY2xpY2s7aW5uZXJodG1sO3RpdGxlOz47bDx3aW5kb3cub3BlbignL3JlZ2lzdHJhdGlvbi9DcmVhdGVBY2NvdW50LmFzcHgnLCdyZWdpc3RlcicsJ3Rvb2xiYXI9bm8sbG9jYXRpb249bm8sc3RhdHVzPXllcyxtZW51YmFyPW5vLHNjcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsd2lkdGg9NzIwLGhlaWdodD01MjAnKVw7IHJldHVybiBmYWxzZTtjcmVhdGUgDQoJCQkJCWFuIGFjY291bnQ7TGluayBvcGVucyBpbiBhIG5ldyB3aW5kb3c7Pj47Oz47dDxwPGw8b25rZXlwcmVzczs+O2w8ZmlyZURlZmF1bHRCdXR0b24oJ09ubGluZVNlcnZpY2VzTG9naW5TdGVhbHRoX1Zpc2FMb2dpbkNvbnRyb2xfbG9naW5JbWFnZUJ1dHRvbicpOz4+Ozs+O3Q8cDxsPG9ua2V5cHJlc3M7PjtsPGZpcmVEZWZhdWx0QnV0dG9uKCdPbmxpbmVTZXJ2aWNlc0xvZ2luU3RlYWx0aF9WaXNhTG9naW5Db250cm9sX2xvZ2luSW1hZ2VCdXR0b24nKTs+Pjs7Pjt0PDtsPGk8MT47PjtsPHQ8cDxsPFRleHQ7VmlzaWJsZTs+O2w8O288Zj47Pj47Oz47Pj47dDxwPGw8b25jbGljaztpbm5lcmh0bWw7dGl0bGU7PjtsPHdpbmRvdy5vcGVuKCcvUmVnaXN0cmF0aW9uL0ZvcmdvdFBhc3N3b3JkU3RlcDEuYXNweCcsJ1JlZ2lzdHJhdGlvbicsJ3Rvb2xiYXI9bm8sbG9jYXRpb249bm8sc3RhdHVzPXllcyxtZW51YmFyPW5vLHNjcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsd2lkdGg9NjAwLGhlaWdodD00MzQnKVw7IHJldHVybiBmYWxzZTtGb3Jnb3R0ZW4gcGFzc3dvcmQ/O0xpbmsgb3BlbnMgaW4gYSBuZXcgd2luZG93Oz4+Ozs+O3Q8cDxsPG9uY2xpY2s7aW5uZXJodG1sO3RpdGxlOz47bDx3aW5kb3cub3BlbignaHR0cDovL2Zvcm1zaGVscC5pbW1pZ3JhdGlvbi5nb3Z0Lm56L1NraWxsZWRNaWdyYW50L0V4cHJlc3Npb25PZkludGVyZXN0L0NBTG9naW4uaHRtJywnbmV3cG9wdXAnLCd0b29sYmFyPW5vLGxvY2F0aW9uPW5vLHN0YXR1cz15ZXMsbWVudWJhcj1ubyxzY3JvbGxiYXJzPXllcyxyZXNpemFibGU9eWVzLHdpZHRoPTYwMCxoZWlnaHQ9NDM0JylcOyByZXR1cm4gZmFsc2U7Q2FuJ3QgbG9naW4/O0xpbmsgb3BlbnMgaW4gYSBuZXcgd2luZG93Oz4+Ozs+Oz4+Oz4+Oz4+O3Q8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47dDw7bDxpPDA+O2k8Mj47PjtsPHQ8cDxwPGw8VmlzaWJsZTs+O2w8bzx0Pjs+Pjs+O2w8aTwwPjtpPDI+O2k8ND47aTw2PjtpPDg+O2k8MTA+O2k8MTI+O2k8MTQ+O2k8MTY+O2k8MTg+O2k8MjI+O2k8MjQ+O2k8MjY+O2k8Mjg+Oz47bDx0PDtsPGk8MD47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88dD47Pj47bDxpPDE+Oz47bDx0PHA8bDxUZXh0Oz47bDwyMCBKYW4gMjAxNjs+Pjs7Pjs+Pjs+Pjt0PDtsPGk8MT47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47Pj47dDw7bDxpPDA+O2k8Mj47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47dDxwPGw8VmlzaWJsZTs+O2w8bzxmPjs+Pjs7Pjs+Pjt0PDtsPGk8MD47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47Pj47dDw7bDxpPDA+Oz47bDx0PHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+O2w8aTwxPjs+O2w8dDw7bDxpPDA+Oz47bDx0PHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+Ozs+Oz4+Oz4+Oz4+O3Q8cDxwPGw8VmlzaWJsZTs+O2w8bzxmPjs+Pjs+O2w8aTwxPjs+O2w8dDw7bDxpPDk+Oz47bDx0PHA8cDxsPEVuYWJsZWQ7VmlzaWJsZTs+O2w8bzxmPjtvPGY+Oz4+Oz47Oz47Pj47Pj47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+Oz47bDxpPDA+Oz47bDx0PHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+O2w8aTw3Pjs+O2w8dDxAMDw7Ozs7Ozs7Ozs7Pjs7Pjs+Pjs+Pjt0PHA8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47PjtsPGk8MT47aTwzPjtpPDU+Oz47bDx0PDtsPGk8MT47aTwzPjs+O2w8dDxwPGw8VGV4dDs+O2w8XDxsYWJlbCBmb3I9IkZvb3Rlcl9uZXdGb290ZXJfVmlld0luZm9Gb3JMaW5rc19WaWV3SW5mb0ZvckxpbmtzTGlzdCJcPjs+Pjs7Pjt0PHA8bDxUZXh0Oz47bDxcPC9sYWJlbFw+Oz4+Ozs+Oz4+O3Q8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47dDx0PHA8cDxsPERhdGFUZXh0RmllbGQ7RGF0YVZhbHVlRmllbGQ7PjtsPGtleTt2YWx1ZTs+Pjs+O3Q8aTwyPjtAPFxlO1xlOz47QDxcZTtcZTs+Pjs+Ozs+Oz4+O3Q8cDxwPGw8VmlzaWJsZTs+O2w8bzxmPjs+Pjs+O2w8aTwxPjtpPDM+O2k8NT47PjtsPHQ8O2w8aTwxPjs+O2w8dDxwPGw8VGV4dDs+O2w8XDxsYWJlbCBmb3I9IkZvb3Rlcl9uZXdGb290ZXJfSVdhbnRUb0xpbmtzX0lXYW50VG9MaW5rc0xpc3QiXD47Pj47Oz47Pj47dDxwPGw8VmlzaWJsZTs+O2w8bzxmPjs+PjtsPGk8MD47PjtsPHQ8cDxsPFRleHQ7PjtsPFw8bGFiZWwgZm9yPSJGb290ZXJfbmV3Rm9vdGVyX0lXYW50VG9MaW5rc19JV2FudFRvTGlua3NMaXN0Ilw+Oz4+Ozs+Oz4+O3Q8dDxwPHA8bDxEYXRhVGV4dEZpZWxkO0RhdGFWYWx1ZUZpZWxkOz47bDxrZXk7dmFsdWU7Pj47Pjt0PGk8Mj47QDxcZTtcZTs+O0A8XGU7XGU7Pj47Pjs7Pjs+Pjt0PDtsPGk8Mj47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47bDxpPDM+Oz47bDx0PHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+Ozs+Oz4+Oz4+O3Q8O2w8aTwwPjs+O2w8dDxwPGw8VmlzaWJsZTs+O2w8bzxmPjs+Pjs7Pjs+Pjt0PDtsPGk8MD47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47Pj47dDxwPGw8VmlzaWJsZTs+O2w8bzxmPjs+Pjs7Pjt0PDtsPGk8MD47aTwyPjtpPDQ+O2k8Nj47PjtsPHQ8O2w8aTwxPjtpPDM+O2k8NT47PjtsPHQ8cDxsPFRleHQ7PjtsPFw8QSBocmVmPSJodHRwOi8vd3d3Lm5ld3plYWxhbmQuZ292dC5uei8iXD5cPElNRyBib3JkZXI9IjAiIGFsdD0iR28gdG8gd3d3Lm5ld3plYWxhbmQuZ292dC5uei4gIiBzcmM9Ii9OUi9yZG9ubHlyZXMvRjdBMjE2NDQtNDVCMy00QzM1LUE1MUYtMjlFN0RENjg3RTk3LzAvbnpnb3Z0bG9nby5wbmciXD5cPC9BXD4mbmJzcFw7Jm5ic3BcOzs+Pjs7Pjt0PHA8bDxUZXh0Oz47bDxcZTs+Pjs7Pjt0PHA8bDxUZXh0Oz47bDxcZTs+Pjs7Pjs+Pjt0PDtsPGk8MD47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47bDxpPDA+O2k8MT47aTwyPjs+O2w8dDw7bDxpPDA+Oz47bDx0PHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+Ozs+Oz4+O3Q8O2w8aTwwPjs+O2w8dDxwPGw8VmlzaWJsZTs+O2w8bzxmPjs+Pjs7Pjs+Pjt0PDtsPGk8MD47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47Pj47Pj47Pj47dDw7bDxpPDA+Oz47bDx0PHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+Ozs+Oz4+O3Q8O2w8aTwwPjs+O2w8dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+Oz47Oz47Pj47Pj47Pj47dDw7bDxpPDE+O2k8Mz47aTw3PjtpPDk+O2k8MTE+O2k8MTM+O2k8MTU+O2k8MTc+O2k8MTk+O2k8MjE+O2k8MjM+O2k8Mjk+Oz47bDx0PHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+Ozs+O3Q8O2w8aTwwPjs+O2w8dDxwPGw8VmlzaWJsZTs+O2w8bzx0Pjs+PjtsPGk8MT47PjtsPHQ8cDxsPFRleHQ7PjtsPDIwIEphbiAyMDE2Oz4+Ozs+Oz4+Oz4+O3Q8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47bDxpPDE+Oz47bDx0PDtsPGk8MT47aTwzPjtpPDU+Oz47bDx0PDtsPGk8MT47PjtsPHQ8cDxsPFRleHQ7PjtsPFw8bGFiZWwgZm9yPSJGb290ZXJfTWlncmFudFNpdGVTdGVhbHRoX0lXYW50VG9MaW5rc19JV2FudFRvTGlua3NMaXN0Ilw+Oz4+Ozs+Oz4+O3Q8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47bDxpPDA+Oz47bDx0PHA8bDxUZXh0Oz47bDxcPGxhYmVsIGZvcj0iRm9vdGVyX01pZ3JhbnRTaXRlU3RlYWx0aF9JV2FudFRvTGlua3NfSVdhbnRUb0xpbmtzTGlzdCJcPjs+Pjs7Pjs+Pjt0PHQ8cDxwPGw8RGF0YVRleHRGaWVsZDtEYXRhVmFsdWVGaWVsZDs+O2w8a2V5O3ZhbHVlOz4+Oz47dDxpPDI+O0A8XGU7XGU7PjtAPFxlO1xlOz4+Oz47Oz47Pj47Pj47dDxwPGw8VmlzaWJsZTs+O2w8bzxmPjs+PjtsPGk8MT47PjtsPHQ8O2w8aTwxPjtpPDM+O2k8NT47PjtsPHQ8O2w8aTwxPjtpPDM+Oz47bDx0PHA8bDxUZXh0Oz47bDxcPGxhYmVsIGZvcj0iRm9vdGVyX0NvbW11bml0eVNpdGVTdGVhbHRoX1ZpZXdJbmZvRm9yTGlua3NfVmlld0luZm9Gb3JMaW5rc0xpc3QiXD47Pj47Oz47dDxwPGw8VGV4dDs+O2w8XDwvbGFiZWxcPjs+Pjs7Pjs+Pjt0PHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+Ozs+O3Q8dDxwPHA8bDxEYXRhVGV4dEZpZWxkO0RhdGFWYWx1ZUZpZWxkOz47bDxrZXk7dmFsdWU7Pj47Pjt0PGk8Mj47QDxcZTtcZTs+O0A8XGU7XGU7Pj47Pjs7Pjs+Pjs+Pjt0PDtsPGk8MT47PjtsPHQ8cDxwPGw8VmlzaWJsZTs+O2w8bzxmPjs+Pjs+O2w8aTw1PjtpPDc+O2k8OT47PjtsPHQ8O2w8aTwxPjs+O2w8dDw7bDxpPDE+Oz47bDx0PDtsPGk8MD47PjtsPHQ8O2w8aTwxPjs+O2w8dDxAMDw7Ozs7Ozs7Ozs7Pjs7Pjs+Pjs+Pjs+Pjs+Pjt0PDtsPGk8MT47PjtsPHQ8O2w8aTwxPjs+O2w8dDw7bDxpPDA+Oz47bDx0PDtsPGk8MT47PjtsPHQ8QDA8Ozs7Ozs7Ozs7Oz47Oz47Pj47Pj47Pj47Pj47dDw7bDxpPDE+Oz47bDx0PDtsPGk8MT47PjtsPHQ8O2w8aTwwPjs+O2w8dDw7bDxpPDE+Oz47bDx0PEAwPDs7Ozs7Ozs7Ozs+Ozs+Oz4+Oz4+Oz4+Oz4+Oz4+Oz4+O3Q8cDxwPGw8VmlzaWJsZTs+O2w8bzxmPjs+Pjs+O2w8aTwxPjs+O2w8dDw7bDxpPDE+O2k8Mz47PjtsPHQ8cDxsPGhyZWY7dGl0bGU7b25jbGljazs+O2w8aHR0cDovL2Zvcm1zaGVscC5pbW1pZ3JhdGlvbi5nb3Z0Lm56L29ubGluZXNlcnZpY2VzL2hlbHAvb25saW5lc2VydmljZXMuaHRtO09wZW5zIGEgbmV3IHdpbmRvdzt3aW5kb3cub3BlbignaHR0cDovL2Zvcm1zaGVscC5pbW1pZ3JhdGlvbi5nb3Z0Lm56L29ubGluZXNlcnZpY2VzL2hlbHAvb25saW5lc2VydmljZXMuaHRtJywnJywndG9vbGJhcj1ubyxsb2NhdGlvbj1ubyxzdGF0dXM9bm8sbWVudWJhcj1ubyxzY3JvbGxiYXJzPXllcyxyZXNpemFibGU9eWVzLHdpZHRoPTc1MCxoZWlnaHQ9NDUwJylcOyByZXR1cm4gZmFsc2U7Pj47Oz47dDxwPHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+Oz47bDxpPDE+O2k8Mz47aTw1Pjs+O2w8dDxwPGw8dGl0bGU7aHJlZjtvbmNsaWNrO2lubmVyaHRtbDs+O2w8TGluayBvcGVucyBpbiBhIG5ldyB3aW5kb3c7L2Nzc20vVXNlcnMvSG9tZS5hc3B4O3dpbmRvdy5vcGVuKCcvY3NzbS9Vc2Vycy9Ib21lLmFzcHgnLCdDU1NNJywndG9vbGJhcj1ubyxsb2NhdGlvbj1ubyxzdGF0dXM9eWVzLG1lbnViYXI9bm8sc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx3aWR0aD04NDAsaGVpZ2h0PTUyMCcpXDsgcmV0dXJuIGZhbHNlO0V4cHJlc3Npb24gb2YgSW50ZXJlc3Q7Pj47Oz47dDxwPGw8aHJlZjt0aXRsZTtvbmNsaWNrO2lubmVyaHRtbDs+O2w8L1NpbHZlckZlcm4vSG9tZS9JbmRleDtMaW5rIG9wZW5zIGluIGEgbmV3IHdpbmRvdzt3aW5kb3cub3BlbignL1NpbHZlckZlcm4vSG9tZS9JbmRleCcsJ1NpbHZlckZlcm4nLCd0b29sYmFyPW5vLGxvY2F0aW9uPW5vLHN0YXR1cz15ZXMsbWVudWJhcj1ubyxzY3JvbGxiYXJzPXllcyxyZXNpemFibGU9eWVzLHdpZHRoPTg0MCxoZWlnaHQ9NTIwJylcOyByZXR1cm4gZmFsc2U7U2lsdmVyIEZlcm4gSm9iIFNlYXJjaDs+Pjs7Pjt0PHA8bDx0aXRsZTtocmVmO29uY2xpY2s7aW5uZXJodG1sOz47bDxMaW5rIG9wZW5zIGluIGEgbmV3IHdpbmRvdzsvV29ya2luZ0hvbGlkYXkvO3dpbmRvdy5vcGVuKCcvV29ya2luZ0hvbGlkYXkvJywnV0hTJywndG9vbGJhcj1ubyxsb2NhdGlvbj1ubyxzdGF0dXM9eWVzLG1lbnViYXI9bm8sc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx3aWR0aD04NDAsaGVpZ2h0PTUyMCcpXDsgcmV0dXJuIGZhbHNlO1dvcmtpbmcgSG9saWRheTs+Pjs7Pjs+Pjs+Pjs+Pjt0PHA8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47PjtsPGk8MT47PjtsPHQ8O2w8aTwxPjs+O2w8dDxwPGw8dGl0bGU7b25jbGljaztpbm5lcmh0bWw7PjtsPExpbmsgb3BlbnMgaW4gYSBuZXcgd2luZG93O3dpbmRvdy5vcGVuKCdodHRwOi8vZm9ybXNoZWxwLmltbWlncmF0aW9uLmdvdnQubnovb25saW5lc2VydmljZXMvaGVscC9tZXNzYWdlcy5odG0nLCduZXdwb3B1cCcsJ3Rvb2xiYXI9bm8sbG9jYXRpb249bm8sc3RhdHVzPXllcyxtZW51YmFyPW5vLHNjcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsd2lkdGg9NjAwLGhlaWdodD00MzQnKVw7IHJldHVybiBmYWxzZTtcZTs+Pjs7Pjs+Pjs+Pjt0PDtsPGk8Mj47PjtsPHQ8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47bDxpPDM+Oz47bDx0PHA8bDxWaXNpYmxlOz47bDxvPGY+Oz4+Ozs+Oz4+Oz4+O3Q8O2w8aTwwPjs+O2w8dDxwPGw8VmlzaWJsZTs+O2w8bzx0Pjs+Pjs7Pjs+Pjt0PHA8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47PjtsPGk8MT47PjtsPHQ8O2w8aTwxPjs+O2w8dDxwPHA8bDxUZXh0Oz47bDwwMSBKYW4gMDAwMSwgMDA6MDA7Pj47Pjs7Pjs+Pjs+Pjt0PDtsPGk8MT47aTwzPjtpPDU+Oz47bDx0PHA8bDxUZXh0Oz47bDxcPEEgaHJlZj0iaHR0cDovL3d3dy5uZXd6ZWFsYW5kLmdvdnQubnovIlw+XDxJTUcgYm9yZGVyPSIwIiBhbHQ9IkdvIHRvIHd3dy5uZXd6ZWFsYW5kLmdvdnQubnouICIgc3JjPSIvTlIvcmRvbmx5cmVzL0Y3QTIxNjQ0LTQ1QjMtNEMzNS1BNTFGLTI5RTdERDY4N0U5Ny8wL256Z292dGxvZ28ucG5nIlw+XDwvQVw+Jm5ic3BcOyZuYnNwXDs7Pj47Oz47dDxwPGw8VGV4dDs+O2w8XGU7Pj47Oz47dDxwPGw8VGV4dDs+O2w8XGU7Pj47Oz47Pj47dDw7bDxpPDA+Oz47bDx0PHA8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Pjs7Pjs+Pjs+Pjs+Pjs+Pjs+PjtsPEhlYWRlckNvbW11bml0eUhvbWVwYWdlOlNlYXJjaENvbnRyb2w6YnRuR287T25saW5lU2VydmljZXNMb2dpblN0ZWFsdGg6VmlzYUxvZ2luQ29udHJvbDpsb2dpbkltYWdlQnV0dG9uOz4+MRFslnnt7JUG0D+wEpoxXupIys8=",
        "__VIEWSTATEGENERATOR"                                           => "D25317F4",
        "HeaderCommunityHomepage:SearchControl:txtSearchString"          => "",
        "VisaDropDown"                                                   => "/secure/Login+Working+Holiday.htm",
        "OnlineServicesLoginStealth:VisaLoginControl:userNameTextBox"    => @config["name"],
        "OnlineServicesLoginStealth:VisaLoginControl:passwordTextBox"    => @config["password"],
        "OnlineServicesLoginStealth:VisaLoginControl:loginImageButton.x" => "0",
        "OnlineServicesLoginStealth:VisaLoginControl:loginImageButton.y" => "0"
      }.to_query
    end
  end

  def create
    res = @conn.post do |req|
      req.url "/WORKINGHOLIDAY/Application/Create.aspx?CountryId=#{@config["country_id"]}"

      req.body = {
        "__VIEWSTATE"                                                    => "/wEPDwUKMTM3MTkyOTkyMw9kFgJmD2QWAgIDD2QWAgIDD2QWBgIBDw8WAh4HVmlzaWJsZWhkZAIDD2QWBAIBDw8WAh4EVGV4dAUFSXRhbHlkZAIDDw8WAh8BBRNTY2hlbWUgaXMgYXZhaWxhYmxlZGQCBQ9kFgICAQ8WCB4EaHJlZgVIaHR0cDovL2Zvcm1zaGVscC5pbW1pZ3JhdGlvbi5nb3Z0Lm56L29ubGluZXNlcnZpY2VzL3doc29ubGluZS90ZXJtc29mdXNlHgdvbmNsaWNrBdEBd2luZG93Lm9wZW4oJ2h0dHA6Ly9mb3Jtc2hlbHAuaW1taWdyYXRpb24uZ292dC5uei9vbmxpbmVzZXJ2aWNlcy93aHNvbmxpbmUvdGVybXNvZnVzZScsJ25ld3BvcHVwJywndG9vbGJhcj1ubyxsb2NhdGlvbj1ubyxzdGF0dXM9eWVzLG1lbnViYXI9bm8sc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx3aWR0aD02MDAsaGVpZ2h0PTQzNCcpOyByZXR1cm4gZmFsc2UeCWlubmVyaHRtbAUUVGVybXMgYW5kIENvbmRpdGlvbnMeBXRpdGxlBRpMaW5rIG9wZW5zIGluIGEgbmV3IHdpbmRvd2QYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFKGN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkYXBwbHlOb3dCdXR0b27AYDsoFQsPUdIib2zLCJLqKMQZjw==",
        "__VIEWSTATEGENERATOR"                                           => "1FE46394",
        "__EVENTVALIDATION"                                              => "/wEWAgKezPrdBgLk5N/TBMhFs7e0uf8iHseWxGwhgE2kRQ6f",
        "ctl00$ContentPlaceHolder1$applyNowButton.x"                     => "27",
        "ctl00$ContentPlaceHolder1$applyNowButton.y"                     => "4"
      }.to_query
    end

    is_success = res.headers[:Location] && res.headers[:Location].include?("ApplicationId")
    if is_success
      @data["application_id"] = res.headers[:Location].split("=")[1]
      @logger.info("application_id: " + @data["application_id"])
    else
      @logger.info "Failed to create an application"
    end

    is_success
  end

  def personal1
    res = @conn.post do |req|
      req.url "/WorkingHoliday/Wizard/Personal1.aspx?ApplicationId=#{@data["application_id"]}&IndividualType=Primary&IndividualIndex=1"

      personal1 = @config["personal1"]
      req.body = {
        "__VIEWSTATE"                                                                             => "/wEPDwUIMTQzMzk5MzQPFgIeEENvbmN1cnJlbmN5U3RhbXAFJDYzYzZlODYxLTRhOWYtNGJmZi05NGRhLTEyMzhiMmM3MzUxNxYCZg9kFgICAw9kFgICAw9kFgYCAQ9kFgJmD2QWDAIFDw8WAh4HVmlzaWJsZWhkZAIJDw8WAh8BaGRkAgsPDxYCHwFoZGQCDw9kFgICAQ8QDxYCHgdDaGVja2VkaGRkZGQCEw9kFgYCAQ8PFgIfAWhkFgICAQ8QZGQWAGQCAw9kFgJmD2QWAmYPZBYCZg9kFgICAQ8WAh4LXyFJdGVtQ291bnQCBBYIZg9kFgYCAQ8WAh4EVGV4dAUTPGRpdiBjbGFzcz1jdXJyZW50PmQCAg8WBh4Dc3JjBSJ+L0ltYWdlcy9UYWJjb250cm9sL2ljb25fZXJyb3IuZ2lmHgNhbHQFD0NvbnRhaW5zIEVycm9ycx4FdGl0bGUFD0NvbnRhaW5zIEVycm9yc2QCBA8PFggeCENzc0NsYXNzBQ5uZXd0YWJidXR0b25vbh4PQ29tbWFuZEFyZ3VtZW50BWQvV29ya2luZ0hvbGlkYXkvV2l6YXJkL1BlcnNvbmFsMS5hc3B4P0FwcGxpY2F0aW9uSWQ9MTUwMDUxOCZJbmRpdmlkdWFsVHlwZT1QcmltYXJ5JkluZGl2aWR1YWxJbmRleD0xHwQFCFBlcnNvbmFsHgRfIVNCAgIWAh8HBRBQZXJzb25hbCBEZXRhaWxzZAIBD2QWBAICDxYGHwUFIn4vSW1hZ2VzL1RhYmNvbnRyb2wvaWNvbl9lcnJvci5naWYfBgUPQ29udGFpbnMgRXJyb3JzHwcFD0NvbnRhaW5zIEVycm9yc2QCBA8PFgQfCQVjL1dvcmtpbmdIb2xpZGF5L1dpemFyZC9NZWRpY2FsMS5hc3B4P0FwcGxpY2F0aW9uSWQ9MTUwMDUxOCZJbmRpdmlkdWFsVHlwZT1QcmltYXJ5JkluZGl2aWR1YWxJbmRleD0xHwQFBkhlYWx0aBYCHwcFD01lZGljYWwgRGV0YWlsc2QCAg9kFgQCAg8WBh8FBSJ+L0ltYWdlcy9UYWJjb250cm9sL2ljb25fZXJyb3IuZ2lmHwYFD0NvbnRhaW5zIEVycm9ycx8HBQ9Db250YWlucyBFcnJvcnNkAgQPDxYEHwkFZC9Xb3JraW5nSG9saWRheS9XaXphcmQvQ2hhcmFjdGVyLmFzcHg/QXBwbGljYXRpb25JZD0xNTAwNTE4JkluZGl2aWR1YWxUeXBlPVByaW1hcnkmSW5kaXZpZHVhbEluZGV4PTEfBAUJQ2hhcmFjdGVyFgIfBwUJQ2hhcmFjdGVyZAIDD2QWBAICDxYGHwUFIn4vSW1hZ2VzL1RhYmNvbnRyb2wvaWNvbl9lcnJvci5naWYfBgUPQ29udGFpbnMgRXJyb3JzHwcFD0NvbnRhaW5zIEVycm9yc2QCBA8PFgQfCQVxL1dvcmtpbmdIb2xpZGF5L1dpemFyZC9Xb3JraW5nSG9saWRheVNwZWNpZmljLmFzcHg/QXBwbGljYXRpb25JZD0xNTAwNTE4JkluZGl2aWR1YWxUeXBlPVByaW1hcnkmSW5kaXZpZHVhbEluZGV4PTEfBAUYV29ya2luZyBIb2xpZGF5IFNwZWNpZmljFgIfBwU2UXVlc3Rpb25zIFNwZWNpZmljIHRvIHlvdXIgV29ya2luZyBIb2xpZGF5IGFwcGxpY2F0aW9uZAIFD2QWAgIBD2QWAmYPFgIeBWNsYXNzBQ50YWJ0YWJsZWxldmVsMhYCZg9kFgJmD2QWAgIBDxYCHwMCAxYGZg9kFgYCAQ8WAh8EBRM8ZGl2IGNsYXNzPWN1cnJlbnQ+ZAICDxYCHwFoZAIEDw8WCB8IBQ5uZXd0YWJidXR0b25vbh8JBWQvV29ya2luZ0hvbGlkYXkvV2l6YXJkL1BlcnNvbmFsMS5hc3B4P0FwcGxpY2F0aW9uSWQ9MTUwMDUxOCZJbmRpdmlkdWFsVHlwZT1QcmltYXJ5JkluZGl2aWR1YWxJbmRleD0xHwQFEFBlcnNvbmFsIERldGFpbHMfCgICFgIfBwUQUGVyc29uYWwgRGV0YWlsc2QCAQ9kFgQCAg8WAh8BaGQCBA8PFgQfCQVkL1dvcmtpbmdIb2xpZGF5L1dpemFyZC9QZXJzb25hbDIuYXNweD9BcHBsaWNhdGlvbklkPTE1MDA1MTgmSW5kaXZpZHVhbFR5cGU9UHJpbWFyeSZJbmRpdmlkdWFsSW5kZXg9MR8EBQ5JZGVudGlmaWNhdGlvbhYCHwcFFklkZW50aWZpY2F0aW9uIERldGFpbHNkAgIPZBYEAgIPFgIfAWhkAgQPDxYEHwkFZC9Xb3JraW5nSG9saWRheS9XaXphcmQvUGVyc29uYWwzLmFzcHg/QXBwbGljYXRpb25JZD0xNTAwNTE4JkluZGl2aWR1YWxUeXBlPVByaW1hcnkmSW5kaXZpZHVhbEluZGV4PTEfBAUST2NjdXBhdGlvbiBEZXRhaWxzFgIfBwUST2NjdXBhdGlvbiBEZXRhaWxzZAIVDxYKHgtjZWxsc3BhY2luZwUBMB4LY2VsbHBhZGRpbmcFATIeBmJvcmRlcgUBMB8LBQlzaXRldGFibGUfAWcWAmYPFgIeBnZhbGlnbgUDdG9wFgICAQ9kFgICAQ8PFgIfAWdkFgICAQ8WAh8EBfQBDQoJCQkJCQk8cD5Zb3Ugc2hvdWxkIGNvbXBsZXRlIGFsbCBvZiB0aGUgcGFnZXMgaW4gdGhpcyBzZWN0aW9uIGJlZm9yZSBwcm9jZWVkaW5nIHRvIHRoZSBuZXh0IHNlY3Rpb24uPC9wPg0KCQkJCQkJPHA+VGhlIGluZm9ybWF0aW9uIGFib3V0IHlvdSBpcyBjb2xsZWN0ZWQgdG8gZGV0ZXJtaW5lIHlvdXIgZWxpZ2liaWxpdHkgZm9yIGEgd29yayB2aXNhIHVuZGVyIGEgV29ya2luZyBIb2xpZGF5IFNjaGVtZS48L3A+DQoJCQkJCWQCBQ8WCB8NBQEyHwwFATAfDgUBMB8LBQlzaXRldGFibGUWAgIBDxYCHw8FA3RvcBYCAgEPZBYKAgEPDxYUHjljdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHBlcnNvbkRldGFpbHMkZ2l2ZW5OYW1lM1RleHRib3hlHjxjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHBlcnNvbkRldGFpbHMkZGF0ZU9mQml0aERhdGVQaWNrZXJlHjljdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHBlcnNvbkRldGFpbHMkZ2l2ZW5OYW1lMlRleHRib3hlHjljdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHBlcnNvbkRldGFpbHMkb3RoZXJOYW1lc1RleHRCb3hlHjpjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHBlcnNvbkRldGFpbHMkZ2VuZGVyRHJvcERvd25MaXN0ZR45Y3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRwZXJzb25EZXRhaWxzJGZhbWlseU5hbWVUZXh0Qm94ZR45Y3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRwZXJzb25EZXRhaWxzJG90aGVyVGl0bGVUZXh0Qm94ZR45Y3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRwZXJzb25EZXRhaWxzJHRpdGxlRHJvcERvd25MaXN0ZR45Y3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRwZXJzb25EZXRhaWxzJGdpdmVuTmFtZTFUZXh0Ym94ZR47Y3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRwZXJzb25EZXRhaWxzJENvdW50cnlEcm9wRG93bkxpc3RlZBY4AgEPDxYEHgRXcmFwZx4JTWF4TGVuZ3RoAjIWAh4EU2l6ZQUCMzBkAgMPDxYGHwgFEUVycm9yTWVzc2FnZVNtYWxsHgdUb29sVGlwBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICZGQCBQ8PFgIfAWhkZAIHDw8WBB8aZx8bAh4WAh8cBQIzMGQCCQ8PFgYfCAURRXJyb3JNZXNzYWdlU21hbGwfHQUSRmllbGQgaXMgbWFuZGF0b3J5HwoCAmRkAgsPDxYCHwFoZGQCDQ8PFgQfGmcfGwIeFgIfHAUCMzBkAg8PDxYIHwgFEUVycm9yTWVzc2FnZVNtYWxsHx0FEkZpZWxkIGlzIG1hbmRhdG9yeR8KAgIfAWhkZAIRDw8WAh8BaGRkAhMPDxYEHxpnHxsCHhYCHxwFAjMwZAIVDw8WCB8IBRFFcnJvck1lc3NhZ2VTbWFsbB8dBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICHwFoZGQCFw8PFgIfAWhkZAIbDw8WBB8aZx8bAv8BFgIfHAUCMzBkAh0PDxYIHwgFEUVycm9yTWVzc2FnZVNtYWxsHx0FEkZpZWxkIGlzIG1hbmRhdG9yeR8KAgIfAWhkZAIfDw8WAh8BaGRkAiEPEA8WBh4NRGF0YVRleHRGaWVsZAUFVmFsdWUeDkRhdGFWYWx1ZUZpZWxkBQNLZXkeC18hRGF0YUJvdW5kZ2QQFQcQU2VsZWN0IGFuIG9wdGlvbgNNciADTXJzAk1zBE1pc3MCRHIFT3RoZXIVBwABMQEyATMBNAE1ATYUKwMHZ2dnZ2dnZ2RkAiMPDxYIHwgFEUVycm9yTWVzc2FnZVNtYWxsHx0FEkZpZWxkIGlzIG1hbmRhdG9yeR8KAgIfAWhkZAIlDw8WAh8BaGRkAicPDxYEHxpnHxsCHhYCHxwFAjMwZAIpDw8WCB8IBRFFcnJvck1lc3NhZ2VTbWFsbB8dBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICHwFoZGQCKw8PFgIfAWhkZAItDxAPFgYfHgUFVmFsdWUfHwUDS2V5HyBnZBAVAxBTZWxlY3QgYW4gb3B0aW9uBE1hbGUGRmVtYWxlFQMAAU0BRhQrAwNnZ2dkZAIvDw8WBh8IBRFFcnJvck1lc3NhZ2VTbWFsbB8dBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICZGQCMQ8PFgIfAWhkZAI1Dw8WBh8IBRFFcnJvck1lc3NhZ2VTbWFsbB8dBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICZGQCNw8PFgIfAWhkZAI7Dw8WBh8IBRFFcnJvck1lc3NhZ2VTbWFsbB8dBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICZGQCPQ8PFgIfAWhkZAIDD2QWCAIBD2QWAgIBDxYEHwQFISh3aGVyZSB5b3UgYXJlIGN1cnJlbnRseSBsaXZpbmcpLh8BZ2QCAw8PFg4eS2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkYWRkcmVzc0NvbnRhY3REZXRhaWxzJGFkZHJlc3Mkc3RyZWV0TnVtYmVyVGV4dGJveGUeR2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkYWRkcmVzc0NvbnRhY3REZXRhaWxzJGFkZHJlc3MkYWRkcmVzczFUZXh0Qm94ZR5FY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRhZGRyZXNzQ29udGFjdERldGFpbHMkYWRkcmVzcyRzdWJ1cmJUZXh0Qm94ZR5JY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRhZGRyZXNzQ29udGFjdERldGFpbHMkYWRkcmVzcyRwb3N0YWxDb2RlVGV4dEJveGUeQ2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkYWRkcmVzc0NvbnRhY3REZXRhaWxzJGFkZHJlc3MkY2l0eVRleHRCb3hlHkxjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGFkZHJlc3NDb250YWN0RGV0YWlscyRhZGRyZXNzJHByb3ZpbmNlU3RhdGVUZXh0Qm94ZR5LY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRhZGRyZXNzQ29udGFjdERldGFpbHMkYWRkcmVzcyRjb3VudHJ5RHJvcERvd25MaXN0ZWQWKgIBDw8WBB8bAggfGmcWAh8cBQE4ZAICDw8WCB8dBRJGaWVsZCBpcyBtYW5kYXRvcnkfCAURRXJyb3JNZXNzYWdlU21hbGwfCgICHwFoZGQCBA8PFgIfAWhkZAIGDw8WBB8bAmQfGmcWAh8cBQIzMGQCBw8PFgYfHQUSRmllbGQgaXMgbWFuZGF0b3J5HwgFEUVycm9yTWVzc2FnZVNtYWxsHwoCAmRkAgkPDxYCHwFoZGQCCw8PFgQfGwJkHxpnFgIfHAUCMzBkAgwPDxYIHx0FEkZpZWxkIGlzIG1hbmRhdG9yeR8IBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgIfAWhkZAIODw8WAh8BaGRkAhAPDxYEHxsCZB8aZxYCHxwFAjMwZAIRDw8WBh8dBRJGaWVsZCBpcyBtYW5kYXRvcnkfCAURRXJyb3JNZXNzYWdlU21hbGwfCgICZGQCEw8PFgIfAWhkZAIVDw8WBB8bAh4fGmcWAh8cBQIzMGQCFg8PFggfHQUSRmllbGQgaXMgbWFuZGF0b3J5HwgFEUVycm9yTWVzc2FnZVNtYWxsHwoCAh8BaGRkAhgPDxYCHwFoZGQCGg8PFgQfGwIPHxpnFgIfHAUCMTVkAhsPDxYIHx0FEkZpZWxkIGlzIG1hbmRhdG9yeR8IBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgIfAWhkZAIdDw8WAh8BaGRkAh8PDxYCHwFoZGQCIw8PFgYfHQUSRmllbGQgaXMgbWFuZGF0b3J5HwgFEUVycm9yTWVzc2FnZVNtYWxsHwoCAmRkAiUPDxYCHwFoZGQCBQ8WBB8EBUUoUGxlYXNlIHByb3ZpZGUgdGhlIHRlbGVwaG9uZSBudW1iZXJzIGF0IHdoaWNoIHlvdSBjYW4gYmUgY29udGFjdGVkKS4fAWdkAgcPDxYKHlFjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGFkZHJlc3NDb250YWN0RGV0YWlscyRjb250YWN0RGV0YWlscyRwaG9uZU51bWJlclRleHRCb3hlHlZjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGFkZHJlc3NDb250YWN0RGV0YWlscyRjb250YWN0RGV0YWlscyRwaG9uZU51bWJlck5pZ2h0VGV4dEJveGUeV2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkYWRkcmVzc0NvbnRhY3REZXRhaWxzJGNvbnRhY3REZXRhaWxzJHBob25lTnVtYmVyTW9iaWxlVGV4dEJveGUeT2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkYWRkcmVzc0NvbnRhY3REZXRhaWxzJGNvbnRhY3REZXRhaWxzJGZheE51bWJlclRleHRib3hlHlJjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGFkZHJlc3NDb250YWN0RGV0YWlscyRjb250YWN0RGV0YWlscyRlbWFpbEFkZHJlc3NUZXh0Qm94ZWQWIAIDDw8WBB8aZx8bAhkWAh8cBQIyNWQCBQ8PFggfCAURRXJyb3JNZXNzYWdlU21hbGwfHQUSRmllbGQgaXMgbWFuZGF0b3J5HwoCAh8BaGRkAgcPDxYCHwFoZGQCCw8PFgQfGmcfGwIZFgIfHAUCMjVkAg0PDxYIHwgFEUVycm9yTWVzc2FnZVNtYWxsHx0FEkZpZWxkIGlzIG1hbmRhdG9yeR8KAgIfAWhkZAIPDw8WAh8BaGRkAhEPDxYEHxpnHxsCGRYCHxwFAjI1ZAITDw8WCB8IBRFFcnJvck1lc3NhZ2VTbWFsbB8dBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICHwFoZGQCFQ8PFgIfAWhkZAIXDw8WBB8aZx8bAhkWAh8cBQIyNWQCGQ8PFggfCAURRXJyb3JNZXNzYWdlU21hbGwfHQUSRmllbGQgaXMgbWFuZGF0b3J5HwoCAh8BaGRkAhsPDxYCHwFoZGQCHQ8WBB8EBUIodGhpcyBhZGRyZXNzIHdpbGwgYmUgdXNlZCB0byBjb250YWN0IHlvdSBhYm91dCB0aGlzIGFwcGxpY2F0aW9uKS4fAWdkAh8PDxYEHxpnHxsCZBYCHxwFAjMwZAIhDw8WBh8IBRFFcnJvck1lc3NhZ2VTbWFsbB8dBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICZGQCIw8PFgIfAWhkZAIFDw8WAh5BY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRoYXNBZ2VudCRyZXByZXNlbnRlZEJ5QWdlbnREcm9wZG93bmxpc3RlZBYIAgEPFggeBGhyZWYFNmh0dHA6Ly9nbG9zc2FyeS5pbW1pZ3JhdGlvbi5nb3Z0Lm56L2ltbWlncmF0aW9uYWR2aXNlch4Hb25jbGljawW/AXdpbmRvdy5vcGVuKCdodHRwOi8vZ2xvc3NhcnkuaW1taWdyYXRpb24uZ292dC5uei9pbW1pZ3JhdGlvbmFkdmlzZXInLCduZXdwb3B1cCcsJ3Rvb2xiYXI9bm8sbG9jYXRpb249bm8sc3RhdHVzPXllcyxtZW51YmFyPW5vLHNjcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsd2lkdGg9NjAwLGhlaWdodD00MzQnKTsgcmV0dXJuIGZhbHNlHglpbm5lcmh0bWwFE2ltbWlncmF0aW9uIGFkdmlzZXIfBwUaTGluayBvcGVucyBpbiBhIG5ldyB3aW5kb3dkAgMPEA8WBh8eBQVWYWx1ZR8fBQNLZXkfIGdkEBUDEFNlbGVjdCBhbiBvcHRpb24CTm8DWWVzFQMAAk5vA1llcxQrAwNnZ2dkZAIFDw8WBh8IBRFFcnJvck1lc3NhZ2VTbWFsbB8dBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICZGQCBw8PFgIfAWhkZAIHDw8WAh5NY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRjb21tdW5pY2F0aW9uTWV0aG9kJGNvbW11bmljYXRpb25NZXRob2REcm9wRG93bkxpc3RlZBYGAgEPEA8WBh8eBQVWYWx1ZR8fBQNLZXkfIGdkEBUCEFNlbGVjdCBhbiBvcHRpb24FRW1haWwVAgABMRQrAwJnZ2RkAgMPDxYGHwgFEUVycm9yTWVzc2FnZVNtYWxsHx0FEkZpZWxkIGlzIG1hbmRhdG9yeR8KAgJkZAIFDw8WAh8BaGRkAgkPDxYCHkFjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGhhc0NyZWRpdENhcmQkaGFzQ3JlZGl0Q2FyZERyb3BEb3dubGlzdGVkFgYCAQ8QDxYGHx4FBVZhbHVlHx8FA0tleR8gZ2QQFQMQU2VsZWN0IGFuIG9wdGlvbgJObwNZZXMVAwACTm8DWWVzFCsDA2dnZ2RkAgMPDxYGHwgFEUVycm9yTWVzc2FnZVNtYWxsHx0FEkZpZWxkIGlzIG1hbmRhdG9yeR8KAgJkZAIFDw8WAh8BaGRkAgcPZBYCAgEPZBYMAgUPDxYCHwFoZGQCCQ8PFgIfAWhkZAILDw8WAh8BaGRkAg8PDxYCHwFoZBYCAgEPEA8WAh8CaGRkZGQCEw8PFgIfAWhkFgYCAQ9kFgICAQ8QZGQWAGQCAw9kFgJmD2QWAmYPZBYCZg9kFgICAQ8WAh8DZmQCBQ9kFgICAQ9kFgJmD2QWAmYPZBYCZg9kFgICAQ8WAh8DZmQCFQ8WCB8MBQEwHw0FATIfDgUBMB8LBQlzaXRldGFibGUWAmYPFgIfDwUDdG9wZBgBBR5fX0NvbnRyb2xzUmVxdWlyZVBvc3RCYWNrS2V5X18WCQVCY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSR3aXphcmRQYWdlSGVhZGVyJG5hdiRwcmV2aW91c0ltYWdlQnV0dG9uBT1jdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VIZWFkZXIkbmF2JHZhbGlkYXRlQnV0dG9uBUdjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VIZWFkZXIkbmF2JGNvbXBsZXRlTGF0ZXJJbWFnZUJ1dHRvbgU+Y3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSR3aXphcmRQYWdlSGVhZGVyJG5hdiRuZXh0SW1hZ2VCdXR0b24FYmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUhlYWRlciRuYXYkbWFuZGF0b3J5RmllbGRzJGRpc3BsYXlNYW5kYXRvcnlGaWVsZEVycm9yc0NoZWNrQm94BVJjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VGb290ZXIkd2l6YXJkUGFnZU5hdmlnYXRvciRwcmV2aW91c0ltYWdlQnV0dG9uBU1jdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VGb290ZXIkd2l6YXJkUGFnZU5hdmlnYXRvciR2YWxpZGF0ZUJ1dHRvbgVXY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSR3aXphcmRQYWdlRm9vdGVyJHdpemFyZFBhZ2VOYXZpZ2F0b3IkY29tcGxldGVMYXRlckltYWdlQnV0dG9uBU5jdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VGb290ZXIkd2l6YXJkUGFnZU5hdmlnYXRvciRuZXh0SW1hZ2VCdXR0b26JxbLcBA86iRmW2IEYwYgtPXfMxg==",
        "__VIEWSTATEGENERATOR"                                                                    => "CF5D6564",
        "__EVENTVALIDATION"                                                                       => "/wEWqgQC9d3bzA4C667TwQkCrY+z1A4C39aligwC6dq83Q8Ckdvqng8CzoP9mQwC/YCL8AMCrNfGlQgCs/Ko8wsCkdilig8Ckdjp7AYCkdj9pwYCm6+kjwMC27nXuQQC27nT2QQC27nP+QQC/uXN8gYC7LTXlAIC49v9+g4C4tv9+g4C4dv9+g4C4Nv9+g4C59v9+g4C5tv9+g4CnrjQ9QEC4PTjogICg5vJzA4CupvJzA4C6ZW1PALl+p/SDALi+p/SDALj+p/SDALg+p/SDALx+p/SDAL++p/SDALm+t/RDALm+tPRDALm+tfRDALm+uvRDALm+u/RDALm+uPRDALm+ufRDALm+vvRDALm+r/SDALm+rPSDALn+t/RDALn+tPRDALn+tfRDALn+uvRDALn+u/RDALn+uPRDALn+ufRDALn+vvRDALn+r/SDALn+rPSDAK3lYDYDwLk+t/RDALk+tPRDALk+tfRDALk+uvRDALk+u/RDALk+uPRDALk+ufRDALk+vvRDALk+r/SDALk+rPSDALl+t/RDALl+tPRDALl+tfRDALl+uvRDALl+u/RDALl+uPRDALl+ufRDALl+vvRDALl+r/SDALl+rPSDALi+t/RDALi+tPRDALi+tfRDALi+uvRDALi+u/RDALi+uPRDAKQ/OfFCQLi+ufRDALi+vvRDALi+r/SDALi+rPSDALj+t/RDALj+tPRDALj+tfRDALj+uvRDALj+u/RDALj+uPRDALj+ufRDALj+vvRDALj+r/SDALj+rPSDALg+t/RDALg+tPRDALg+tfRDALg+uvRDALg+u/RDALg+uPRDALg+ufRDALg+vvRDALg+r/SDALg+rPSDALx+t/RDALx+tPRDALx+tfRDALx+uvRDALx+u/RDALx+uPRDALx+ufRDALx+vvRDALx+r/SDALx+rPSDAL++t/RDAL++tPRDAL++tfRDAL++uvRDAL++u/RDAL++uPRDAL++ufRDAL++vvRDAL++r/SDAL++rPSDALAu7iGCwKtgp7zBQK2lfzYDwKT/NPFCQL8xrGzBALZqZeYDgKisPWFCAKPm+vyAgK48ausCgKF2ImZBALAu7yGCwKtgpLzBQK2lfDYDwKT/NfFCQL8xrWzBALBu8yFCwLZqauYDgKisImFCAKPm+/yAgK48a+sCgKF2I2ZBALAu7CGCwKtgpbzBQK2lfTYDwKT/OvFCQL8xsmyBALZqa+YDgKisI2FCAKPm+PyAgK48aOsCgKF2IGZBALAu7SGCwKtgqrzBQK2lYjYDwKT/O/FCQL8xs2yBALZqaOYDgKisIGFCAKPm+fyAgK48aesCgKF2IWZBALAu8iFCwKtgq7zBQK2lYzYDwK58busCgKT/OPFCQL8xsGyBALZqaeYDgKisIWFCAKPm/vyAgK48busCgKF2JmZBALAu8yFCwKtgqLzBQK2lYDYDwKT/OfFCQL8xsWyBALZqbuYDgKisJmFCAKPm//yAgK48b+sCgKF2J2ZBALAu8CFCwKtgqbzBQK2lYTYDwKT/PvFCQL8xtmyBALZqb+YDgKisJ2FCAKPm/PyAgK48bOsCgKF2JGZBALAu8SFCwKtgrrzBQK2lZjYDwKT/P/FCQL8xt2yBALZqbOYDgKisJGFCAKPm/fyAgK48besCgKF2JWZBALAu5iGCwKtgv7zBQK2ldzYDwKT/LPGCQL8xpGzBALZqfeYDgKMm/vyAgKC2JmZBAKisNWFCAKPm8vyAgK48YusCgL9xsWyBAKF2OmZBALAu5yGCwKtgvLzBQK2ldDYDwKT/LfGCQL8xpWzBALZqYuYDgKqgqLzBQKisOmFCAKPm8/yAgK48Y+sCgKF2O2ZBALBu7iGCwKqgp7zBQK3lfzYDwKQ/NPFCQL9xrGzBALGqZeYDgKjsPWFCAKMm+vyAgK58ausCgKC2ImZBALBu7yGCwKqgpLzBQK3lfDYDwKQ/NfFCQL9xrWzBALGqauYDgKjsImFCAKMm+/yAgK58a+sCgKC2I2ZBALBu7CGCwKqgpbzBQK3lfTYDwKQ/OvFCQL9xsmyBALGqa+YDgKjsI2FCAKMm+PyAgK58aOsCgKC2IGZBALBu7SGCwKqgqrzBQK3lYjYDwKQ/O/FCQL9xs2yBALGqaOYDgKjsIGFCAKMm+fyAgK58aesCgKC2IWZBALBu8iFCwKqgq7zBQK3lYzYDwKQ/OPFCQL9xsGyBALGqaeYDgK/0KuiBAKfk57kAgKFlbr4BQKmosvDCQKduJ3ZAQKMivW6CQLjupDWCQLv1bq4BQLo1bq4BQLp1bq4BQLq1bq4BQL71bq4BQL01bq4BQLs1fq7BQLs1fa7BQLs1fK7BQLs1c67BQLs1cq7BQLs1ca7BQLs1cK7BQLs1d67BQLs1Zq4BQLs1Za4BQLt1fq7BQLt1fa7BQLt1fK7BQLt1c67BQLt1cq7BQLt1ca7BQLt1cK7BQLt1d67BQLt1Zq4BQLt1Za4BQK9uqWyBgLu1fq7BQLu1fa7BQLu1fK7BQLu1c67BQLu1cq7BQLu1ca7BQLu1cK7BQLu1d67BQLu1Zq4BQLu1Za4BQLv1fq7BQLv1fa7BQLv1fK7BQLv1c67BQLv1cq7BQLv1ca7BQLv1cK7BQLv1d67BQLv1Zq4BQLv1Za4BQLo1fq7BQLo1fa7BQLo1fK7BQLo1c67BQLo1cq7BQLo1ca7BQKa08IvAujVwrsFAujV3rsFAujVmrgFAujVlrgFAunV+rsFAunV9rsFAunV8rsFAunVzrsFAunVyrsFAunVxrsFAunVwrsFAunV3rsFAunVmrgFAunVlrgFAurV+rsFAurV9rsFAurV8rsFAurVzrsFAurVyrsFAurVxrsFAurVwrsFAurV3rsFAurVmrgFAurVlrgFAvvV+rsFAvvV9rsFAvvV8rsFAvvVzrsFAvvVyrsFAvvVxrsFAvvVwrsFAvvV3rsFAvvVmrgFAvvVlrgFAvTV+rsFAvTV9rsFAvTV8rsFAvTVzrsFAvTVyrsFAvTVxrsFAvTVwrsFAvTV3rsFAvTVmrgFAvTVlrgFAsqUnewCAqetu5kMAry62bIGApnT9i8C9umU2Q0C04ay8gcCqJ/Q7wEChbTOmAsCst6OxgMCj/es8w0CypSZ7AICp623mQwCvLrVsgYCmdPyLwL26ZDZDQLLlOnvAgLTho7yBwKon6zvAQKFtMqYCwKy3orGAwKP96jzDQLKlJXsAgKnrbOZDAK8utGyBgKZ084vAvbp7NgNAtOGivIHAqifqO8BAoW0xpgLArLehsYDAo/3pPMNAsqUkewCAqetj5kMAry6rbIGApnTyi8C9uno2A0C04aG8gcCqJ+k7wEChbTCmAsCst6CxgMCj/eg8w0CypTt7wICp62LmQwCvLqpsgYCs96exgMCmdPGLwL26eTYDQLThoLyBwKon6DvAQKFtN6YCwKy3p7GAwKP97zzDQLKlOnvAgKnrYeZDAK8uqWyBgKZ08IvAvbp4NgNAtOGnvIHAqifvO8BAoW02pgLArLemsYDAo/3uPMNAsqU5e8CAqetg5kMAry6obIGApnT3i8C9un82A0C04aa8gcCqJ+47wEChbTWmAsCst6WxgMCj/e08w0CypTh7wICp62fmQwCvLq9sgYCmdPaLwL26fjYDQLThpbyBwKon7TvAQKFtNKYCwKy3pLGAwKP97DzDQLKlL3sAgKnrduZDAK8uvmyBgKZ05YsAvbptNkNAtOG0vIHAoa03pgLAoj3vPMNAqif8O8BAoW07pgLArLersYDAvfp4NgNAo/3zPMNAsqUuewCAqet15kMAry69bIGApnTkiwC9umw2Q0C04au8gcCoK2HmQwCqJ/M7wEChbTqmAsCst6qxgMCj/fI8w0Cy5Sd7AICoK27mQwCvbrZsgYCmtP2LwL36ZTZDQLMhrLyBwKpn9DvAQKGtM6YCwKz3o7GAwKI96zzDQLLlJnsAgKgrbeZDAK9utWyBgKa0/IvAvfpkNkNAsyGjvIHAqmfrO8BAoa0ypgLArPeisYDAoj3qPMNAsuUlewCAqCts5kMAr260bIGAprTzi8C9+ns2A0CzIaK8gcCqZ+o7wEChrTGmAsCs96GxgMCiPek8w0Cy5SR7AICoK2PmQwCvbqtsgYCmtPKLwL36ejYDQLMhobyBwKpn6TvAQKGtMKYCwKz3oLGAwKI96DzDQLLlO3vAgKgrYuZDAK9uqmyBgKa08YvAvfp5NgNAsyGgvIHAszw7bgCAqPwnpYIAteinpkLAq/Tk/YEAonsuNUGApqq1vUOAvjF+JoCAri3yNkBApz0tf0FApObn5MJAuWv2y0Ch8D1wgwCx7LFgQ8CuJPYzggCs9GZ3AECmNSGhgEC++rljg+6BX0EdgNLYAXUWZNxoxdGDpGVLA==",
        "ctl00$ContentPlaceHolder1$wizardPageHeader$nav$pageTabs$TabHeaders$ctl01$tabButton"      => "Identification",
        "ctl00$ContentPlaceHolder1$personDetails$familyNameTextBox"                               => personal1["family_name"],
        "ctl00$ContentPlaceHolder1$personDetails$givenName1Textbox"                               => personal1["given_name"],
        "ctl00$ContentPlaceHolder1$personDetails$givenName2Textbox"                               => "",
        "ctl00$ContentPlaceHolder1$personDetails$givenName3Textbox"                               => "",
        "ctl00$ContentPlaceHolder1$personDetails$otherNamesTextBox"                               => "",
        "ctl00$ContentPlaceHolder1$personDetails$titleDropDownList"                               => personal1["title"],
        "ctl00$ContentPlaceHolder1$personDetails$otherTitleTextBox"                               => "",
        "ctl00$ContentPlaceHolder1$personDetails$genderDropDownList"                              => personal1["gender"],
        "ctl00_ContentPlaceHolder1_personDetails_dateOfBithDatePicker_Day"                        => personal1["day"],
        "ctl00_ContentPlaceHolder1_personDetails_dateOfBithDatePicker_Month"                      => personal1["month"],
        "ctl00_ContentPlaceHolder1_personDetails_dateOfBithDatePicker_Year"                       => personal1["year"],
        "ctl00$ContentPlaceHolder1$personDetails$dateOfBithDatePicker"                            => "",
        "ctl00_ContentPlaceHolder1_personDetails_dateOfBithDatePicker_MaxDate"                    => "24 May 2016",
        "ctl00_ContentPlaceHolder1_personDetails_dateOfBithDatePicker_MinDate"                    => "24 May 1985",
        "ctl00_ContentPlaceHolder1_personDetails_dateOfBithDatePicker_ControlState"               => "/wEXBQUMU2VsZWN0ZWREYXRlBgAAAAAAAAAABQxQcmV2aW91c0RhdGUGAAAAAAAAAAAFB01heERhdGUGAGA+xAGD04gFEFNlbGVjdGVkRGF0ZVRleHQFBTAtMC0wBQdNaW5EYXRlBgAg39BawbCI",
        "ctl00$ContentPlaceHolder1$personDetails$CountryDropDownList"                             => personal1["country_id"],
        "ctl00$ContentPlaceHolder1$addressContactDetails$address$streetNumberTextbox"             => "",
        "ctl00$ContentPlaceHolder1$addressContactDetails$address$address1TextBox"                 => personal1["street"],
        "ctl00$ContentPlaceHolder1$addressContactDetails$address$suburbTextBox"                   => personal1["suburb"],
        "ctl00$ContentPlaceHolder1$addressContactDetails$address$cityTextBox"                     => personal1["city"],
        "ctl00$ContentPlaceHolder1$addressContactDetails$address$provinceStateTextBox"            => "",
        "ctl00$ContentPlaceHolder1$addressContactDetails$address$postalCodeTextBox"               => "",
        "ctl00$ContentPlaceHolder1$addressContactDetails$address$countryDropDownList"             => personal1["country_id"],
        "ctl00$ContentPlaceHolder1$addressContactDetails$contactDetails$phoneNumberTextBox"       => "",
        "ctl00$ContentPlaceHolder1$addressContactDetails$contactDetails$phoneNumberNightTextBox"  => "",
        "ctl00$ContentPlaceHolder1$addressContactDetails$contactDetails$phoneNumberMobileTextBox" => "",
        "ctl00$ContentPlaceHolder1$addressContactDetails$contactDetails$faxNumberTextbox"         => "",
        "ctl00$ContentPlaceHolder1$addressContactDetails$contactDetails$emailAddressTextBox"      => personal1["email"],
        "ctl00$ContentPlaceHolder1$hasAgent$representedByAgentDropdownlist"                       => "No",
        "ctl00$ContentPlaceHolder1$communicationMethod$communicationMethodDropDownList"           => "1",
        "ctl00$ContentPlaceHolder1$hasCreditCard$hasCreditCardDropDownlist"                       => "Yes"
      }.to_query
    end
  end

  def personal2
    res = @conn.post do |req|
      req.url "/WorkingHoliday/Wizard/Personal2.aspx?ApplicationId=#{@data["application_id"]}&IndividualType=Primary&IndividualIndex=1"

      personal2 = @config["personal2"]
      req.body = {
        "__EVENTTARGET"                                                                         => "ctl00$ContentPlaceHolder1$medicalConditions$renalDialysisDropDownList",
        "__EVENTARGUMENT"                                                                       => "",
        "__VIEWSTATE"                                                                           => "/wEPDwULLTEwMjc1NDA2ODAPFgIeEENvbmN1cnJlbmN5U3RhbXAFJGY5NTIyMTgyLWY5ZjItNGE1MC04NGQ0LTMxNTMyNzgzMTM4MRYCZg9kFgICAw9kFgICAw9kFgYCAQ9kFgJmD2QWDAIFDw8WAh4HVmlzaWJsZWhkZAIJDw8WAh8BaGRkAgsPDxYCHwFoZGQCDw9kFgICAQ8QDxYCHgdDaGVja2VkaGRkZGQCEw9kFgYCAQ8PFgIfAWhkFgICAQ8QZGQWAGQCAw9kFgJmD2QWAmYPZBYCZg9kFgICAQ8WAh4LXyFJdGVtQ291bnQCBBYIZg9kFgYCAQ8WAh4EVGV4dAUTPGRpdiBjbGFzcz1jdXJyZW50PmQCAg8WBh4Dc3JjBSJ+L0ltYWdlcy9UYWJjb250cm9sL2ljb25fZXJyb3IuZ2lmHgNhbHQFD0NvbnRhaW5zIEVycm9ycx4FdGl0bGUFD0NvbnRhaW5zIEVycm9yc2QCBA8PFggeCENzc0NsYXNzBQ5uZXd0YWJidXR0b25vbh4PQ29tbWFuZEFyZ3VtZW50BWQvV29ya2luZ0hvbGlkYXkvV2l6YXJkL1BlcnNvbmFsMS5hc3B4P0FwcGxpY2F0aW9uSWQ9MTUwMDUxOCZJbmRpdmlkdWFsVHlwZT1QcmltYXJ5JkluZGl2aWR1YWxJbmRleD0xHwQFCFBlcnNvbmFsHgRfIVNCAgIWAh8HBRBQZXJzb25hbCBEZXRhaWxzZAIBD2QWBAICDxYGHwUFIn4vSW1hZ2VzL1RhYmNvbnRyb2wvaWNvbl9lcnJvci5naWYfBgUPQ29udGFpbnMgRXJyb3JzHwcFD0NvbnRhaW5zIEVycm9yc2QCBA8PFgQfCQVjL1dvcmtpbmdIb2xpZGF5L1dpemFyZC9NZWRpY2FsMS5hc3B4P0FwcGxpY2F0aW9uSWQ9MTUwMDUxOCZJbmRpdmlkdWFsVHlwZT1QcmltYXJ5JkluZGl2aWR1YWxJbmRleD0xHwQFBkhlYWx0aBYCHwcFD01lZGljYWwgRGV0YWlsc2QCAg9kFgQCAg8WBh8FBSJ+L0ltYWdlcy9UYWJjb250cm9sL2ljb25fZXJyb3IuZ2lmHwYFD0NvbnRhaW5zIEVycm9ycx8HBQ9Db250YWlucyBFcnJvcnNkAgQPDxYEHwkFZC9Xb3JraW5nSG9saWRheS9XaXphcmQvQ2hhcmFjdGVyLmFzcHg/QXBwbGljYXRpb25JZD0xNTAwNTE4JkluZGl2aWR1YWxUeXBlPVByaW1hcnkmSW5kaXZpZHVhbEluZGV4PTEfBAUJQ2hhcmFjdGVyFgIfBwUJQ2hhcmFjdGVyZAIDD2QWBAICDxYGHwUFIn4vSW1hZ2VzL1RhYmNvbnRyb2wvaWNvbl9lcnJvci5naWYfBgUPQ29udGFpbnMgRXJyb3JzHwcFD0NvbnRhaW5zIEVycm9yc2QCBA8PFgQfCQVxL1dvcmtpbmdIb2xpZGF5L1dpemFyZC9Xb3JraW5nSG9saWRheVNwZWNpZmljLmFzcHg/QXBwbGljYXRpb25JZD0xNTAwNTE4JkluZGl2aWR1YWxUeXBlPVByaW1hcnkmSW5kaXZpZHVhbEluZGV4PTEfBAUYV29ya2luZyBIb2xpZGF5IFNwZWNpZmljFgIfBwU2UXVlc3Rpb25zIFNwZWNpZmljIHRvIHlvdXIgV29ya2luZyBIb2xpZGF5IGFwcGxpY2F0aW9uZAIFD2QWAgIBD2QWAmYPFgIeBWNsYXNzBQ50YWJ0YWJsZWxldmVsMhYCZg9kFgJmD2QWAgIBDxYCHwMCAxYGZg9kFgQCAg8WAh8BaGQCBA8PFgQfCQVkL1dvcmtpbmdIb2xpZGF5L1dpemFyZC9QZXJzb25hbDEuYXNweD9BcHBsaWNhdGlvbklkPTE1MDA1MTgmSW5kaXZpZHVhbFR5cGU9UHJpbWFyeSZJbmRpdmlkdWFsSW5kZXg9MR8EBRBQZXJzb25hbCBEZXRhaWxzFgIfBwUQUGVyc29uYWwgRGV0YWlsc2QCAQ9kFgYCAQ8WAh8EBRM8ZGl2IGNsYXNzPWN1cnJlbnQ+ZAICDxYCHwFoZAIEDw8WCB8IBQ5uZXd0YWJidXR0b25vbh8JBWQvV29ya2luZ0hvbGlkYXkvV2l6YXJkL1BlcnNvbmFsMi5hc3B4P0FwcGxpY2F0aW9uSWQ9MTUwMDUxOCZJbmRpdmlkdWFsVHlwZT1QcmltYXJ5JkluZGl2aWR1YWxJbmRleD0xHwQFDklkZW50aWZpY2F0aW9uHwoCAhYCHwcFFklkZW50aWZpY2F0aW9uIERldGFpbHNkAgIPZBYEAgIPFgIfAWhkAgQPDxYEHwkFZC9Xb3JraW5nSG9saWRheS9XaXphcmQvUGVyc29uYWwzLmFzcHg/QXBwbGljYXRpb25JZD0xNTAwNTE4JkluZGl2aWR1YWxUeXBlPVByaW1hcnkmSW5kaXZpZHVhbEluZGV4PTEfBAUST2NjdXBhdGlvbiBEZXRhaWxzFgIfBwUST2NjdXBhdGlvbiBEZXRhaWxzZAIVDxYKHgtjZWxsc3BhY2luZwUBMB4LY2VsbHBhZGRpbmcFATIeBmJvcmRlcgUBMB8LBQlzaXRldGFibGUfAWcWAmYPFgIeBnZhbGlnbgUDdG9wFgICAQ9kFgICAQ8PFgIfAWdkFgICAQ8WAh8EBfQBDQoJCQkJCQk8cD5Zb3Ugc2hvdWxkIGNvbXBsZXRlIGFsbCBvZiB0aGUgcGFnZXMgaW4gdGhpcyBzZWN0aW9uIGJlZm9yZSBwcm9jZWVkaW5nIHRvIHRoZSBuZXh0IHNlY3Rpb24uPC9wPg0KCQkJCQkJPHA+VGhlIGluZm9ybWF0aW9uIGFib3V0IHlvdSBpcyBjb2xsZWN0ZWQgdG8gZGV0ZXJtaW5lIHlvdXIgZWxpZ2liaWxpdHkgZm9yIGEgd29yayB2aXNhIHVuZGVyIGEgV29ya2luZyBIb2xpZGF5IFNjaGVtZS48L3A+DQoJCQkJCWQCAw8WCB8NBQEyHwwFATAfDgUBMB8LBQlzaXRldGFibGUWBgIBDxYCHw8FA3RvcGQCAg8WAh8PBQN0b3AWAgICD2QWAmYPDxYOHkhjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGlkZW50aWZpY2F0aW9uJG90aGVySWRlbnRpZmljYXRpb25Ecm9wZG93bmxpc3RlHkFjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGlkZW50aWZpY2F0aW9uJG90aGVySXNzdWVEYXRlRGF0ZVBpY2tlcmUeQmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkaWRlbnRpZmljYXRpb24kb3RoZXJFeHBpcnlEYXRlRGF0ZVBpY2tlcmUePmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkaWRlbnRpZmljYXRpb24kcGFzc3BvcnROdW1iZXJUZXh0Qm94ZR5FY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRpZGVudGlmaWNhdGlvbiRjb25maXJtUGFzc3BvcnROdW1iZXJUZXh0Qm94ZR5EY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRpZGVudGlmaWNhdGlvbiRwYXNzcG9ydENvdW50cnlEcm9wRG93bkxpc3RlHkVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGlkZW50aWZpY2F0aW9uJHBhc3Nwb3J0RXhwaXJ5RGF0ZURhdGVQaWNrZXJlZBYiAgEPDxYEHgRXcmFwZx4JTWF4TGVuZ3RoAg8WAh4EU2l6ZQUCMTVkAgMPDxYGHwgFEUVycm9yTWVzc2FnZVNtYWxsHgdUb29sVGlwBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICZGQCBQ8PFgIfAWhkZAIHDw8WBB8XZx8YAg8WAh8ZBQIxNWQCCQ8PFgYfCAURRXJyb3JNZXNzYWdlU21hbGwfGgUSRmllbGQgaXMgbWFuZGF0b3J5HwoCAmRkAgsPDxYCHwFoZGQCEA8PFgYfCAURRXJyb3JNZXNzYWdlU21hbGwfGgUSRmllbGQgaXMgbWFuZGF0b3J5HwoCAmRkAhIPDxYCHwFoZGQCFg8PFgYfCAURRXJyb3JNZXNzYWdlU21hbGwfGgUSRmllbGQgaXMgbWFuZGF0b3J5HwoCAmRkAhgPDxYCHwFoZGQCGg8QDxYGHg1EYXRhVGV4dEZpZWxkBQVWYWx1ZR4ORGF0YVZhbHVlRmllbGQFA0tleR4LXyFEYXRhQm91bmRnZBAVBBBTZWxlY3QgYW4gb3B0aW9uDkRyaXZlciBMaWNlbnNlEUJpcnRoIENlcnRpZmljYXRlC05hdGlvbmFsIElEFQQAATEBMgEzFCsDBGdnZ2dkZAIcDw8WBh8IBRFFcnJvck1lc3NhZ2VTbWFsbB8aBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICZGQCHg8PFgIfAWhkZAIiDw8WBh8IBRFFcnJvck1lc3NhZ2VTbWFsbB8aBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICZGQCJA8PFgIfAWhkZAIoDw8WCB8IBRFFcnJvck1lc3NhZ2VTbWFsbB8aBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICHwFoZGQCKg8PFgIfAWhkZAIDDxYCHw8FA3RvcGQCBQ9kFgICAQ9kFgwCBQ8PFgIfAWhkZAIJDw8WAh8BaGRkAgsPDxYCHwFoZGQCDw8PFgIfAWhkFgICAQ8QDxYCHwJoZGRkZAITDw8WAh8BaGQWBgIBD2QWAgIBDxBkZBYAZAIDD2QWAmYPZBYCZg9kFgJmD2QWAgIBDxYCHwNmZAIFD2QWAgIBD2QWAmYPZBYCZg9kFgJmD2QWAgIBDxYCHwNmZAIVDxYIHwwFATAfDQUBMh8OBQEwHwsFCXNpdGV0YWJsZRYCZg8WAh8PBQN0b3BkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYJBUJjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VIZWFkZXIkbmF2JHByZXZpb3VzSW1hZ2VCdXR0b24FPWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUhlYWRlciRuYXYkdmFsaWRhdGVCdXR0b24FR2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUhlYWRlciRuYXYkY29tcGxldGVMYXRlckltYWdlQnV0dG9uBT5jdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VIZWFkZXIkbmF2JG5leHRJbWFnZUJ1dHRvbgViY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSR3aXphcmRQYWdlSGVhZGVyJG5hdiRtYW5kYXRvcnlGaWVsZHMkZGlzcGxheU1hbmRhdG9yeUZpZWxkRXJyb3JzQ2hlY2tCb3gFUmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUZvb3RlciR3aXphcmRQYWdlTmF2aWdhdG9yJHByZXZpb3VzSW1hZ2VCdXR0b24FTWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUZvb3RlciR3aXphcmRQYWdlTmF2aWdhdG9yJHZhbGlkYXRlQnV0dG9uBVdjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VGb290ZXIkd2l6YXJkUGFnZU5hdmlnYXRvciRjb21wbGV0ZUxhdGVySW1hZ2VCdXR0b24FTmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUZvb3RlciR3aXphcmRQYWdlTmF2aWdhdG9yJG5leHRJbWFnZUJ1dHRvbo25RJU0wnibxPrEiDdshCkvVryG",
        "__VIEWSTATEGENERATOR"                                                                  => "06B3883E",
        "ctl00$ContentPlaceHolder1$wizardPageHeader$nav$sectionTabs$TabHeaders$ctl01$tabButton" => "Health",
        "ctl00$ContentPlaceHolder1$identification$passportNumberTextBox"                        => personal2["passport"],
        "ctl00$ContentPlaceHolder1$identification$confirmPassportNumberTextBox"                 => personal2["passport"],
        "ctl00_ContentPlaceHolder1_identification_passportExpiryDateDatePicker_Day"             => personal2["expiry_date"],
        "ctl00_ContentPlaceHolder1_identification_passportExpiryDateDatePicker_Month"           => personal2["expiry_month"],
        "ctl00_ContentPlaceHolder1_identification_passportExpiryDateDatePicker_Year"            => personal2["expiry_year"],
        "ctl00$ContentPlaceHolder1$identification$passportExpiryDateDatePicker"                 => "",
        "ctl00_ContentPlaceHolder1_identification_passportExpiryDateDatePicker_MaxDate"         => "24 May 2041",
        "ctl00_ContentPlaceHolder1_identification_passportExpiryDateDatePicker_MinDate"         => "24 May 2016",
        "ctl00_ContentPlaceHolder1_identification_passportExpiryDateDatePicker_ControlState"    => "/wEXBQUMU2VsZWN0ZWREYXRlBgAAAAAAAAAABQxQcmV2aW91c0RhdGUGAAAAAAAAAAAFB01heERhdGUGAKAhji2K74gFEFNlbGVjdGVkRGF0ZVRleHQFBTAtMC0wBQdNaW5EYXRlBgBgPsQBg9OI",
        "ctl00$ContentPlaceHolder1$identification$otherIdentificationDropdownlist"              => "3",
        "ctl00_ContentPlaceHolder1_identification_otherIssueDateDatePicker_Day"                 => personal2["issue_date"],
        "ctl00_ContentPlaceHolder1_identification_otherIssueDateDatePicker_Month"               => personal2["issue_month"],
        "ctl00_ContentPlaceHolder1_identification_otherIssueDateDatePicker_Year"                => personal2["issue_year"],
        "ctl00$ContentPlaceHolder1$identification$otherIssueDateDatePicker"                     => "",
        "ctl00_ContentPlaceHolder1_identification_otherIssueDateDatePicker_MaxDate"             => "24 May 2016",
        "ctl00_ContentPlaceHolder1_identification_otherIssueDateDatePicker_MinDate"             => "24 May 1985",
        "ctl00_ContentPlaceHolder1_identification_otherIssueDateDatePicker_ControlState"        => "/wEXBQUMU2VsZWN0ZWREYXRlBgAAAAAAAAAABQxQcmV2aW91c0RhdGUGAAAAAAAAAAAFB01heERhdGUGAGA+xAGD04gFEFNlbGVjdGVkRGF0ZVRleHQFBTAtMC0wBQdNaW5EYXRlBgAg39BawbCI",
        "ctl00_ContentPlaceHolder1_identification_otherExpiryDateDatePicker_Day"                => "0",
        "ctl00_ContentPlaceHolder1_identification_otherExpiryDateDatePicker_Month"              => "0",
        "ctl00_ContentPlaceHolder1_identification_otherExpiryDateDatePicker_Year"               => "0",
        "ctl00$ContentPlaceHolder1$identification$otherExpiryDateDatePicker"                    => "",
        "ctl00_ContentPlaceHolder1_identification_otherExpiryDateDatePicker_MaxDate"            => "24 May 2041",
        "ctl00_ContentPlaceHolder1_identification_otherExpiryDateDatePicker_MinDate"            => "24 May 2016",
        "ctl00_ContentPlaceHolder1_identification_otherExpiryDateDatePicker_ControlState"       => "/wEXBQUMU2VsZWN0ZWREYXRlBgAAAAAAAAAABQxQcmV2aW91c0RhdGUGAAAAAAAAAAAFB01heERhdGUGAKAhji2K74gFEFNlbGVjdGVkRGF0ZVRleHQFBTAtMC0wBQdNaW5EYXRlBgBgPsQBg9OI",
        "ctl00$ContentPlaceHolder1$identification$passportCountryDropDownList"                  => "106"
      }.to_query
    end
  end

  def medical1
    res = @conn.post do |req|
      req.url "/WorkingHoliday/Wizard/Medical1.aspx?ApplicationId=#{@data["application_id"]}&IndividualType=Primary&IndividualIndex=1"

      req.body = {
          "__EVENTTARGET"                                                                         => "ctl00$ContentPlaceHolder1$medicalConditions$renalDialysisDropDownList",
          "__EVENTARGUMENT"                                                                       => "",
          "__VIEWSTATE"                                                                           => "/wEPDwUKMjE0MDAxOTgwMw8WAh4QQ29uY3VycmVuY3lTdGFtcAUkYWUzOWVhN2UtMGM3NS00NjY5LTgyNDEtNWZkMGE4N2IzNDI1FgJmD2QWAgIDD2QWAgIDD2QWBgIBD2QWAmYPZBYMAgUPDxYCHgdWaXNpYmxlaGRkAgkPDxYCHwFoZGQCCw8PFgIfAWhkZAIPD2QWAgIBDxAPFgIeB0NoZWNrZWRoZGRkZAITD2QWBgIBDw8WAh8BaGQWAgIBDxBkZBYAZAIDD2QWAmYPZBYCZg9kFgJmD2QWAgIBDxYCHgtfIUl0ZW1Db3VudAIEFghmD2QWBAICDxYGHgNzcmMFIX4vSW1hZ2VzL1RhYmNvbnRyb2wvaWNvbl90aWNrLmdpZh4DYWx0BQlDb21wbGV0ZWQeBXRpdGxlBQlDb21wbGV0ZWRkAgQPDxYEHg9Db21tYW5kQXJndW1lbnQFZC9Xb3JraW5nSG9saWRheS9XaXphcmQvUGVyc29uYWwxLmFzcHg/QXBwbGljYXRpb25JZD0xNTAwNTE4JkluZGl2aWR1YWxUeXBlPVByaW1hcnkmSW5kaXZpZHVhbEluZGV4PTEeBFRleHQFCFBlcnNvbmFsFgIfBgUQUGVyc29uYWwgRGV0YWlsc2QCAQ9kFgYCAQ8WAh8IBRM8ZGl2IGNsYXNzPWN1cnJlbnQ+ZAICDxYGHwQFIn4vSW1hZ2VzL1RhYmNvbnRyb2wvaWNvbl9lcnJvci5naWYfBQUPQ29udGFpbnMgRXJyb3JzHwYFD0NvbnRhaW5zIEVycm9yc2QCBA8PFggeCENzc0NsYXNzBQ5uZXd0YWJidXR0b25vbh8HBWMvV29ya2luZ0hvbGlkYXkvV2l6YXJkL01lZGljYWwxLmFzcHg/QXBwbGljYXRpb25JZD0xNTAwNTE4JkluZGl2aWR1YWxUeXBlPVByaW1hcnkmSW5kaXZpZHVhbEluZGV4PTEfCAUGSGVhbHRoHgRfIVNCAgIWAh8GBQ9NZWRpY2FsIERldGFpbHNkAgIPZBYEAgIPFgYfBAUifi9JbWFnZXMvVGFiY29udHJvbC9pY29uX2Vycm9yLmdpZh8FBQ9Db250YWlucyBFcnJvcnMfBgUPQ29udGFpbnMgRXJyb3JzZAIEDw8WBB8HBWQvV29ya2luZ0hvbGlkYXkvV2l6YXJkL0NoYXJhY3Rlci5hc3B4P0FwcGxpY2F0aW9uSWQ9MTUwMDUxOCZJbmRpdmlkdWFsVHlwZT1QcmltYXJ5JkluZGl2aWR1YWxJbmRleD0xHwgFCUNoYXJhY3RlchYCHwYFCUNoYXJhY3RlcmQCAw9kFgQCAg8WBh8EBSJ+L0ltYWdlcy9UYWJjb250cm9sL2ljb25fZXJyb3IuZ2lmHwUFD0NvbnRhaW5zIEVycm9ycx8GBQ9Db250YWlucyBFcnJvcnNkAgQPDxYEHwcFcS9Xb3JraW5nSG9saWRheS9XaXphcmQvV29ya2luZ0hvbGlkYXlTcGVjaWZpYy5hc3B4P0FwcGxpY2F0aW9uSWQ9MTUwMDUxOCZJbmRpdmlkdWFsVHlwZT1QcmltYXJ5JkluZGl2aWR1YWxJbmRleD0xHwgFGFdvcmtpbmcgSG9saWRheSBTcGVjaWZpYxYCHwYFNlF1ZXN0aW9ucyBTcGVjaWZpYyB0byB5b3VyIFdvcmtpbmcgSG9saWRheSBhcHBsaWNhdGlvbmQCBQ8PFgIfAWhkFgICAQ9kFgJmD2QWAmYPZBYCZg9kFgICAQ8WAh8DZmQCFQ8WCB4LY2VsbHNwYWNpbmcFATAeC2NlbGxwYWRkaW5nBQEyHgZib3JkZXIFATAeBWNsYXNzBQlzaXRldGFibGUWAmYPFgIeBnZhbGlnbgUDdG9wZAIDDxYIHwwFATIfCwUBMB8NBQEwHw4FCXNpdGV0YWJsZRYIAgEPFgIfDwUDdG9wZAICDxYCHw8FA3RvcBYCAgIPZBYCAgEPFggeBGhyZWYFZmh0dHA6Ly93d3cuaW1taWdyYXRpb24uZ292dC5uei9OUi9yZG9ubHlyZXMvREQyRDJEMjctREQ0OS00QTYyLTk2Q0MtM0ExRjMyMjIzQzhFLzAvMTEyMUFNYXI4YkZJTkFMLnBkZh4Hb25jbGljawXvAXdpbmRvdy5vcGVuKCdodHRwOi8vd3d3LmltbWlncmF0aW9uLmdvdnQubnovTlIvcmRvbmx5cmVzL0REMkQyRDI3LURENDktNEE2Mi05NkNDLTNBMUYzMjIyM0M4RS8wLzExMjFBTWFyOGJGSU5BTC5wZGYnLCduZXdwb3B1cCcsJ3Rvb2xiYXI9bm8sbG9jYXRpb249bm8sc3RhdHVzPXllcyxtZW51YmFyPW5vLHNjcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsd2lkdGg9NjAwLGhlaWdodD00MzQnKTsgcmV0dXJuIGZhbHNlHglpbm5lcmh0bWwFL0hlYWx0aCByZXF1aXJlbWVudHMgbGVhZmxldA0KCQkJCQkJCShOWklTIDExMjEpHwYFGkxpbmsgb3BlbnMgaW4gYSBuZXcgd2luZG93ZAIDDxYCHw8FA3RvcBYCAgIPZBYCAgEPDxYSHkVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJG1lZGljYWxDb25kaXRpb25zJHJlbmFsRGlhbHlzaXNEcm9wRG93bkxpc3RlHkhjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJG1lZGljYWxDb25kaXRpb25zJGhlYWx0aERldGFpbHNJbnRlcmdlblRleHRCb3hlHj5jdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJG1lZGljYWxDb25kaXRpb25zJHRiUmlza0Ryb3BEb3duTGlzdGUeR2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkbWVkaWNhbENvbmRpdGlvbnMkcmVzaWRlbnRhaWxDYXJlRHJvcERvd25MaXN0ZR5HY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRtZWRpY2FsQ29uZGl0aW9ucyRob3NwaXRhbGlzYXRpb25Ecm9wRG93bkxpc3RlHkJjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJG1lZGljYWxDb25kaXRpb25zJGRpc2FiaWxpdHlEcm9wRG93bkxpc3RlHj5jdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJG1lZGljYWxDb25kaXRpb25zJGNhbmNlckRyb3BEb3duTGlzdGUeRGN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkbWVkaWNhbENvbmRpdGlvbnMkdHViZXJjdWxvc2lzRHJvcERvd25MaXN0ZR5EY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRtZWRpY2FsQ29uZGl0aW9ucyRoZWFydERpc2Vhc2VEcm9wRG93bkxpc3RlZBY8AgEPEA8WBh4NRGF0YVRleHRGaWVsZAUFVmFsdWUeDkRhdGFWYWx1ZUZpZWxkBQNLZXkeC18hRGF0YUJvdW5kZ2QQFQMQU2VsZWN0IGFuIG9wdGlvbgJObwNZZXMVAwACTm8DWWVzFCsDA2dnZxYBAgFkAgIPDxYIHwgFByZuYnNwOyoeB1Rvb2xUaXAFEkZpZWxkIGlzIG1hbmRhdG9yeR8JBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgJkZAIEDw8WAh8BaGRkAgYPEA8WBh8cBQVWYWx1ZR8dBQNLZXkfHmdkEBUDEFNlbGVjdCBhbiBvcHRpb24CTm8DWWVzFQMAAk5vA1llcxQrAwNnZ2cWAQIBZAIHDw8WCB8IBQcmbmJzcDsqHx8FEkZpZWxkIGlzIG1hbmRhdG9yeR8JBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgJkZAIJDw8WAh8BaGRkAgsPEA8WBh8cBQVWYWx1ZR8dBQNLZXkfHmdkEBUDEFNlbGVjdCBhbiBvcHRpb24CTm8DWWVzFQMAAk5vA1llcxQrAwNnZ2cWAQIBZAIMDw8WCB8IBQcmbmJzcDsqHx8FEkZpZWxkIGlzIG1hbmRhdG9yeR8JBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgJkZAIODw8WAh8BaGRkAhAPEA8WBh8cBQVWYWx1ZR8dBQNLZXkfHmdkEBUDEFNlbGVjdCBhbiBvcHRpb24CTm8DWWVzFQMAAk5vA1llcxQrAwNnZ2cWAQIBZAIRDw8WCB8IBQcmbmJzcDsqHx8FEkZpZWxkIGlzIG1hbmRhdG9yeR8JBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgJkZAITDw8WAh8BaGRkAhUPEA8WBh8cBQVWYWx1ZR8dBQNLZXkfHmdkEBUDEFNlbGVjdCBhbiBvcHRpb24CTm8DWWVzFQMAAk5vA1llcxQrAwNnZ2cWAQIBZAIWDw8WCB8IBQcmbmJzcDsqHx8FEkZpZWxkIGlzIG1hbmRhdG9yeR8JBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgJkZAIYDw8WAh8BaGRkAhoPEA8WBh8cBQVWYWx1ZR8dBQNLZXkfHmdkEBUDEFNlbGVjdCBhbiBvcHRpb24CTm8DWWVzFQMAAk5vA1llcxQrAwNnZ2cWAQIBZAIbDw8WCB8IBQcmbmJzcDsqHx8FEkZpZWxkIGlzIG1hbmRhdG9yeR8JBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgJkZAIdDw8WAh8BaGRkAh8PEA8WBh8cBQVWYWx1ZR8dBQNLZXkfHmdkEBUDEFNlbGVjdCBhbiBvcHRpb24CTm8DWWVzFQMAAk5vA1llcxQrAwNnZ2cWAQIBZAIgDw8WCB8IBQcmbmJzcDsqHx8FEkZpZWxkIGlzIG1hbmRhdG9yeR8JBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgJkZAIiDw8WAh8BaGRkAiQPDxYCHwFoZBYCAgEPEGRkFgBkAiYPDxYIHwhlHgRXcmFwZx4JTWF4TGVuZ3RoAognHgdFbmFibGVkaBYGHgRTaXplBQIzMB4Kb25rZXlwcmVzcwU4amF2YXNjcmlwdDpyZXR1cm4gKGhhbmRsZU9uS2V5cHJlc3ModGhpcywgNTAwMCwgZXZlbnQpKTseCG9uY2hhbmdlBSZqYXZhc2NyaXB0OmhhbmRsZU9uQ2hhbmdlKHRoaXMsIDUwMDApO2QCKA8PFgofCAUHJm5ic3A7Kh8fBRJGaWVsZCBpcyBtYW5kYXRvcnkfCQURRXJyb3JNZXNzYWdlU21hbGwfCgICHwFoZGQCKQ8PFgIfAWhkZAIrDxYIHxAFOGh0dHA6Ly9nbG9zc2FyeS5pbW1pZ3JhdGlvbi5nb3Z0Lm56L0xvd1RCUmlza0NvdW50cnkuaHRtHxEFwQF3aW5kb3cub3BlbignaHR0cDovL2dsb3NzYXJ5LmltbWlncmF0aW9uLmdvdnQubnovTG93VEJSaXNrQ291bnRyeS5odG0nLCduZXdwb3B1cCcsJ3Rvb2xiYXI9bm8sbG9jYXRpb249bm8sc3RhdHVzPXllcyxtZW51YmFyPW5vLHNjcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsd2lkdGg9NjAwLGhlaWdodD00MzQnKTsgcmV0dXJuIGZhbHNlHxIFFWxvdyANCgkJCQlyaXNrIGZvciBUQh8GBRpMaW5rIG9wZW5zIGluIGEgbmV3IHdpbmRvd2QCLQ8QDxYGHxwFBVZhbHVlHx0FA0tleR8eZ2QQFQMQU2VsZWN0IGFuIG9wdGlvbgJObwNZZXMVAwACTm8DWWVzFCsDA2dnZ2RkAi4PDxYIHwgFByZuYnNwOyofHwUSRmllbGQgaXMgbWFuZGF0b3J5HwkFEUVycm9yTWVzc2FnZVNtYWxsHwoCAmRkAjAPDxYCHwFoZGQCNw8PZBYEHyQFNWphdmFzY3JpcHQ6cmV0dXJuIChoYW5kbGVPbktleXByZXNzKHRoaXMsIDAsIGV2ZW50KSk7HyUFI2phdmFzY3JpcHQ6aGFuZGxlT25DaGFuZ2UodGhpcywgMCk7ZAIEDxYCHw8FA3RvcGQCBQ9kFgICAQ9kFgwCBQ8PFgIfAWhkZAIJDw8WAh8BaGRkAgsPDxYCHwFoZGQCDw8PFgIfAWhkFgICAQ8QDxYCHwJoZGRkZAITDw8WAh8BaGQWBgIBD2QWAgIBDxBkZBYAZAIDD2QWAmYPZBYCZg9kFgJmD2QWAgIBDxYCHwNmZAIFD2QWAgIBD2QWAmYPZBYCZg9kFgJmD2QWAgIBDxYCHwNmZAIVDxYIHwsFATAfDAUBMh8NBQEwHw4FCXNpdGV0YWJsZRYCZg8WAh8PBQN0b3BkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYJBUJjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VIZWFkZXIkbmF2JHByZXZpb3VzSW1hZ2VCdXR0b24FPWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUhlYWRlciRuYXYkdmFsaWRhdGVCdXR0b24FR2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUhlYWRlciRuYXYkY29tcGxldGVMYXRlckltYWdlQnV0dG9uBT5jdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VIZWFkZXIkbmF2JG5leHRJbWFnZUJ1dHRvbgViY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSR3aXphcmRQYWdlSGVhZGVyJG5hdiRtYW5kYXRvcnlGaWVsZHMkZGlzcGxheU1hbmRhdG9yeUZpZWxkRXJyb3JzQ2hlY2tCb3gFUmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUZvb3RlciR3aXphcmRQYWdlTmF2aWdhdG9yJHByZXZpb3VzSW1hZ2VCdXR0b24FTWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUZvb3RlciR3aXphcmRQYWdlTmF2aWdhdG9yJHZhbGlkYXRlQnV0dG9uBVdjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VGb290ZXIkd2l6YXJkUGFnZU5hdmlnYXRvciRjb21wbGV0ZUxhdGVySW1hZ2VCdXR0b24FTmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUZvb3RlciR3aXphcmRQYWdlTmF2aWdhdG9yJG5leHRJbWFnZUJ1dHRvbnfFTB/XwY8Jywd4tkARz3mo2sO/",
          "__VIEWSTATEGENERATOR"                                                                  => "29195504",
          "__EVENTVALIDATION"                                                                     => "/wEWLwLx8OvfDALrrtPBCQKtj7PUDgLf1qWKDALp2rzdDwKR2+qeDwLOg/2ZDAL9gIvwAwKs18aVCAKz8qjzCwLOqsS3CwLOqsS3CwKsxerYBwLst9qbBAKT9eo8ApP16jwC8ZrE0wwCsej0kA8C5fSfqQQC5fSfqQQCh5uxxggCx+mBhQsC8emomwkC8emomwkCk4aG9AUC0/S2twYCkPSqqAoCkPSqqAoC8puExwYCsum0hAUCtLzzgQYCtLzzgQYC1tPd7goClqHtrQkClaGqpAcClaGqpAcC986EywsCt7y0iAgCk/OR+AMC0ILDqAYCsu3txwoC8p/dhAkC3e+lvwMCuJPYzggCs9GZ3AECmNSGhgEC++rljg8XZEIeFzgLPLgDrXdgOk/mf0zf1w==",
          "ctl00$ContentPlaceHolder1$wizardPageHeader$nav$sectionTabs$TabHeaders$ctl02$tabButton" => "Character",
          "ctl00$ContentPlaceHolder1$medicalConditions$renalDialysisDropDownList"                 => "No",
          "ctl00$ContentPlaceHolder1$medicalConditions$tuberculosisDropDownList"                  => "No",
          "ctl00$ContentPlaceHolder1$medicalConditions$cancerDropDownList"                        => "No",
          "ctl00$ContentPlaceHolder1$medicalConditions$heartDiseaseDropDownList"                  => "No",
          "ctl00$ContentPlaceHolder1$medicalConditions$disabilityDropDownList"                    => "No",
          "ctl00$ContentPlaceHolder1$medicalConditions$hospitalisationDropDownList"               => "No",
          "ctl00$ContentPlaceHolder1$medicalConditions$residentailCareDropDownList"               => "No",
          "ctl00$ContentPlaceHolder1$medicalConditions$tbRiskDropDownList"                        => "No"
        }.to_query
    end
  end

  def character
    res = @conn.post do |req|
      req.url "/WorkingHoliday/Wizard/Character.aspx?ApplicationId=#{@data["application_id"]}&IndividualType=Primary&IndividualIndex=1"

      req.body = {
          "__VIEWSTATE"                                                                           => "/wEPDwULLTE5MzEzNTU2NjAPFgIeEENvbmN1cnJlbmN5U3RhbXAFJGM2MmM5ZWUxLWU0NTYtNDdjOS1iYzg5LTY3NjE2MDMwNWZjYRYCZg9kFgICAw9kFgICAw9kFgYCAQ9kFgJmD2QWDAIFDw8WAh4HVmlzaWJsZWhkZAIJDw8WAh8BaGRkAgsPDxYCHwFoZGQCDw9kFgICAQ8QDxYCHgdDaGVja2VkaGRkZGQCEw9kFgYCAQ8PFgIfAWhkFgICAQ8QZGQWAGQCAw9kFgJmD2QWAmYPZBYCZg9kFgICAQ8WAh4LXyFJdGVtQ291bnQCBBYIZg9kFgQCAg8WBh4Dc3JjBSF+L0ltYWdlcy9UYWJjb250cm9sL2ljb25fdGljay5naWYeA2FsdAUJQ29tcGxldGVkHgV0aXRsZQUJQ29tcGxldGVkZAIEDw8WBB4PQ29tbWFuZEFyZ3VtZW50BWQvV29ya2luZ0hvbGlkYXkvV2l6YXJkL1BlcnNvbmFsMS5hc3B4P0FwcGxpY2F0aW9uSWQ9MTUwMDUxOCZJbmRpdmlkdWFsVHlwZT1QcmltYXJ5JkluZGl2aWR1YWxJbmRleD0xHgRUZXh0BQhQZXJzb25hbBYCHwYFEFBlcnNvbmFsIERldGFpbHNkAgEPZBYEAgIPFgYfBAUhfi9JbWFnZXMvVGFiY29udHJvbC9pY29uX3RpY2suZ2lmHwUFCUNvbXBsZXRlZB8GBQlDb21wbGV0ZWRkAgQPDxYEHwcFYy9Xb3JraW5nSG9saWRheS9XaXphcmQvTWVkaWNhbDEuYXNweD9BcHBsaWNhdGlvbklkPTE1MDA1MTgmSW5kaXZpZHVhbFR5cGU9UHJpbWFyeSZJbmRpdmlkdWFsSW5kZXg9MR8IBQZIZWFsdGgWAh8GBQ9NZWRpY2FsIERldGFpbHNkAgIPZBYGAgEPFgIfCAUTPGRpdiBjbGFzcz1jdXJyZW50PmQCAg8WBh8EBSJ+L0ltYWdlcy9UYWJjb250cm9sL2ljb25fZXJyb3IuZ2lmHwUFD0NvbnRhaW5zIEVycm9ycx8GBQ9Db250YWlucyBFcnJvcnNkAgQPDxYIHghDc3NDbGFzcwUObmV3dGFiYnV0dG9ub24fBwVkL1dvcmtpbmdIb2xpZGF5L1dpemFyZC9DaGFyYWN0ZXIuYXNweD9BcHBsaWNhdGlvbklkPTE1MDA1MTgmSW5kaXZpZHVhbFR5cGU9UHJpbWFyeSZJbmRpdmlkdWFsSW5kZXg9MR8IBQlDaGFyYWN0ZXIeBF8hU0ICAhYCHwYFCUNoYXJhY3RlcmQCAw9kFgQCAg8WBh8EBSJ+L0ltYWdlcy9UYWJjb250cm9sL2ljb25fZXJyb3IuZ2lmHwUFD0NvbnRhaW5zIEVycm9ycx8GBQ9Db250YWlucyBFcnJvcnNkAgQPDxYEHwcFcS9Xb3JraW5nSG9saWRheS9XaXphcmQvV29ya2luZ0hvbGlkYXlTcGVjaWZpYy5hc3B4P0FwcGxpY2F0aW9uSWQ9MTUwMDUxOCZJbmRpdmlkdWFsVHlwZT1QcmltYXJ5JkluZGl2aWR1YWxJbmRleD0xHwgFGFdvcmtpbmcgSG9saWRheSBTcGVjaWZpYxYCHwYFNlF1ZXN0aW9ucyBTcGVjaWZpYyB0byB5b3VyIFdvcmtpbmcgSG9saWRheSBhcHBsaWNhdGlvbmQCBQ8PFgIfAWhkFgICAQ9kFgJmD2QWAmYPZBYCZg9kFgICAQ8WAh8DZmQCFQ8WCh4LY2VsbHNwYWNpbmcFATAeC2NlbGxwYWRkaW5nBQEyHgZib3JkZXIFATAeBWNsYXNzBQlzaXRldGFibGUfAWcWAmYPFgIeBnZhbGlnbgUDdG9wFgICAQ9kFgICAQ8PFgIfAWdkFgICAQ8WAh8IBXYNCgkJCQkJCTxwPlRoaXMgc2VjdGlvbiB3aWxsIGhlbHAgdXMgZGV0ZXJtaW5lIHdoZXRoZXIgeW91IGFyZSBhY2NlcHRhYmxlIG9uIGNoYXJhY3RlciBncm91bmRzIGZvciBhIHZpc2EuIDwvcD4NCgkJCQkJZAIDDxYIHwwFATIfCwUBMB8NBQEwHw4FCXNpdGV0YWJsZRYGAgEPFgIfDwUDdG9wZAICDxYCHw8FA3RvcBYCAgIPZBYCAgEPDxYYHjljdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGNoYXJhY3RlciRjb252aWN0ZWREcm9wRG93bkxpc3RlHjdjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGNoYXJhY3RlciRjaGFyZ2VkRHJvcERvd25MaXN0ZR5CY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRjaGFyYWN0ZXIkdW5kZXJJbnZlc3RpZ2F0aW9uRHJvcERvd25MaXN0ZR43Y3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRjaGFyYWN0ZXIkY291bnRyeURyb3BEb3duTGlzdGUeOGN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkY2hhcmFjdGVyJGRlcG9ydGVkRHJvcERvd25MaXN0ZR5CY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRjaGFyYWN0ZXIkaW1wcmlzb25tZW50NVllYXJzRHJvcERvd25MaXN0ZR48Y3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRjaGFyYWN0ZXIkcmVtb3ZhbE9yZGVyRHJvcERvd25MaXN0ZR5AY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRjaGFyYWN0ZXIkZXhjbHVkZVJlbW92ZWREZXRhaWxzVGV4dGJveGUeOGN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkY2hhcmFjdGVyJGV4Y2x1ZGVkRHJvcERvd25MaXN0ZR43Y3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRjaGFyYWN0ZXIkcmVtb3ZlZERyb3BEb3duTGlzdGUeRGN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkY2hhcmFjdGVyJGltcHJpc29ubWVudDEyTW9udGhzRHJvcERvd25MaXN0ZR46Y3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRjaGFyYWN0ZXIkZGVwb3J0ZWREYXRlRGF0ZVBpY2tlcmVkFkQCAQ8QDxYGHg1EYXRhVGV4dEZpZWxkBQVWYWx1ZR4ORGF0YVZhbHVlRmllbGQFA0tleR4LXyFEYXRhQm91bmRnZBAVAxBTZWxlY3QgYW4gb3B0aW9uAk5vA1llcxUDAAJObwNZZXMUKwMDZ2dnZGQCAw8PFgYeB1Rvb2xUaXAFEkZpZWxkIGlzIG1hbmRhdG9yeR8JBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgJkZAIFDw8WAh8BaGRkAgcPEA8WBh8cBQVWYWx1ZR8dBQNLZXkfHmdkEBUDEFNlbGVjdCBhbiBvcHRpb24CTm8DWWVzFQMAAk5vA1llcxQrAwNnZ2dkZAIJDw8WBh8fBRJGaWVsZCBpcyBtYW5kYXRvcnkfCQURRXJyb3JNZXNzYWdlU21hbGwfCgICZGQCCw8PFgIfAWhkZAINDxAPFgYfHAUFVmFsdWUfHQUDS2V5Hx5nZBAVAxBTZWxlY3QgYW4gb3B0aW9uAk5vA1llcxUDAAJObwNZZXMUKwMDZ2dnZGQCDw8PFgYfHwUSRmllbGQgaXMgbWFuZGF0b3J5HwkFEUVycm9yTWVzc2FnZVNtYWxsHwoCAmRkAhEPDxYCHwFoZGQCEw8QDxYGHxwFBVZhbHVlHx0FA0tleR8eZ2QQFQMQU2VsZWN0IGFuIG9wdGlvbgJObwNZZXMVAwACTm8DWWVzFCsDA2dnZ2RkAhUPDxYGHx8FEkZpZWxkIGlzIG1hbmRhdG9yeR8JBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgJkZAIXDw8WAh8BaGRkAhsPDxYIHx8FEkZpZWxkIGlzIG1hbmRhdG9yeR8JBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgIfAWhkZAIdDw8WAh8BaGRkAiEPDxYIHx8FEkZpZWxkIGlzIG1hbmRhdG9yeR8JBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgIfAWhkZAIjDw8WAh8BaGRkAiUPEA8WBh8cBQVWYWx1ZR8dBQNLZXkfHmdkEBUDEFNlbGVjdCBhbiBvcHRpb24CTm8DWWVzFQMAAk5vA1llcxQrAwNnZ2dkZAInDw8WBh8fBRJGaWVsZCBpcyBtYW5kYXRvcnkfCQURRXJyb3JNZXNzYWdlU21hbGwfCgICZGQCKQ8PFgIfAWhkZAIrDxAPFgYfHAUFVmFsdWUfHQUDS2V5Hx5nZBAVAxBTZWxlY3QgYW4gb3B0aW9uAk5vA1llcxUDAAJObwNZZXMUKwMDZ2dnZGQCLQ8PFgYfHwUSRmllbGQgaXMgbWFuZGF0b3J5HwkFEUVycm9yTWVzc2FnZVNtYWxsHwoCAmRkAi8PDxYCHwFoZGQCMQ8QDxYGHxwFBVZhbHVlHx0FA0tleR8eZ2QQFQMQU2VsZWN0IGFuIG9wdGlvbgJObwNZZXMVAwACTm8DWWVzFCsDA2dnZ2RkAjMPDxYGHx8FEkZpZWxkIGlzIG1hbmRhdG9yeR8JBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgJkZAI1Dw8WAh8BaGRkAjcPEA8WBh8cBQVWYWx1ZR8dBQNLZXkfHmdkEBUDEFNlbGVjdCBhbiBvcHRpb24CTm8DWWVzFQMAAk5vA1llcxQrAwNnZ2dkZAI5Dw8WBh8fBRJGaWVsZCBpcyBtYW5kYXRvcnkfCQURRXJyb3JNZXNzYWdlU21hbGwfCgICZGQCOw8PFgIfAWhkZAI9DxAPFgYfHAUFVmFsdWUfHQUDS2V5Hx5nZBAVAxBTZWxlY3QgYW4gb3B0aW9uAk5vA1llcxUDAAJObwNZZXMUKwMDZ2dnZGQCPw8PFgYfHwUSRmllbGQgaXMgbWFuZGF0b3J5HwkFEUVycm9yTWVzc2FnZVNtYWxsHwoCAmRkAkEPDxYCHwFoZGQCQw8PFgYfCGUeBFdyYXBnHglNYXhMZW5ndGgCiCcWBh4EU2l6ZQUCMzAeCm9ua2V5cHJlc3MFOGphdmFzY3JpcHQ6cmV0dXJuIChoYW5kbGVPbktleXByZXNzKHRoaXMsIDUwMDAsIGV2ZW50KSk7HghvbmNoYW5nZQUmamF2YXNjcmlwdDpoYW5kbGVPbkNoYW5nZSh0aGlzLCA1MDAwKTtkAkUPDxYIHx8FEkZpZWxkIGlzIG1hbmRhdG9yeR8JBRFFcnJvck1lc3NhZ2VTbWFsbB8KAgIfAWhkZAJHDw8WAh8BaGRkAgMPFgIfDwUDdG9wZAIFD2QWAgIBD2QWDAIFDw8WAh8BaGRkAgkPDxYCHwFoZGQCCw8PFgIfAWhkZAIPDw8WAh8BaGQWAgIBDxAPFgIfAmhkZGRkAhMPDxYCHwFoZBYGAgEPZBYCAgEPEGRkFgBkAgMPZBYCZg9kFgJmD2QWAmYPZBYCAgEPFgIfA2ZkAgUPZBYCAgEPZBYCZg9kFgJmD2QWAmYPZBYCAgEPFgIfA2ZkAhUPFggfCwUBMB8MBQEyHw0FATAfDgUJc2l0ZXRhYmxlFgJmDxYCHw8FA3RvcGQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgkFQmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUhlYWRlciRuYXYkcHJldmlvdXNJbWFnZUJ1dHRvbgU9Y3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSR3aXphcmRQYWdlSGVhZGVyJG5hdiR2YWxpZGF0ZUJ1dHRvbgVHY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSR3aXphcmRQYWdlSGVhZGVyJG5hdiRjb21wbGV0ZUxhdGVySW1hZ2VCdXR0b24FPmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUhlYWRlciRuYXYkbmV4dEltYWdlQnV0dG9uBWJjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VIZWFkZXIkbmF2JG1hbmRhdG9yeUZpZWxkcyRkaXNwbGF5TWFuZGF0b3J5RmllbGRFcnJvcnNDaGVja0JveAVSY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSR3aXphcmRQYWdlRm9vdGVyJHdpemFyZFBhZ2VOYXZpZ2F0b3IkcHJldmlvdXNJbWFnZUJ1dHRvbgVNY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSR3aXphcmRQYWdlRm9vdGVyJHdpemFyZFBhZ2VOYXZpZ2F0b3IkdmFsaWRhdGVCdXR0b24FV2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUZvb3RlciR3aXphcmRQYWdlTmF2aWdhdG9yJGNvbXBsZXRlTGF0ZXJJbWFnZUJ1dHRvbgVOY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSR3aXphcmRQYWdlRm9vdGVyJHdpemFyZFBhZ2VOYXZpZ2F0b3IkbmV4dEltYWdlQnV0dG9uX8/EdJmmrxREMSNAVDB2iViKCPk=",
          "__VIEWSTATEGENERATOR"                                                                  => "97B90819",
          "__EVENTVALIDATION"                                                                     => "/wEWpQICq/y4xQYC667TwQkCrY+z1A4C39aligwC6dq83Q8Ckdvqng8CzoP9mQwC/YCL8AMCrNfGlQgCs/Ko8wsC88XNnAUCkarj8wkC0djTsAoCgI6Qzg0C4uG+oQECopOO4gICw8nK8AUCoabknwkC4dTU3AoC8bLbjgMCk9314Q8C06/FogwCrLCjQgKg34msDAKn34msDAKm34msDAKl34msDAK034msDAK734msDAKj38mvDAKj38WvDAKj38GvDAKj3/2vDAKj3/mvDAKj3/WvDAKj3/GvDAKj3+2vDAKj36msDAKj36WsDAKi38mvDAKi38WvDAKi38GvDAKi3/2vDAKi3/mvDAKi3/WvDAKi3/GvDAKi3+2vDAKi36msDAKi36WsDALysJamDwKh38mvDAKh38WvDAKh38GvDAKh3/2vDAKh3/mvDAKh3/WvDAKh3/GvDAKh3+2vDAKh36msDAKh36WsDAKg38mvDAKg38WvDAKg38GvDAKg3/2vDAKg3/mvDAKg3/WvDAKg3/GvDAKg3+2vDAKg36msDAKg36WsDAKn38mvDAKn38WvDAKn38GvDAKn3/2vDAKn3/mvDAKn3/WvDALV2fG7CQKn3/GvDAKn3+2vDAKn36msDAKn36WsDAKm38mvDAKm38WvDAKm38GvDAKm3/2vDAKm3/mvDAKm3/WvDAKm3/GvDAKm3+2vDAKm36msDAKm36WsDAKl38mvDAKl38WvDAKl38GvDAKl3/2vDAKl3/mvDAKl3/WvDAKl3/GvDAKl3+2vDAKl36msDAKl36WsDAK038mvDAK038WvDAK038GvDAK03/2vDAK03/mvDAK03/WvDAK03/GvDAK03+2vDAK036msDAK036WsDAK738mvDAK738WvDAK738GvDAK73/2vDAK73/mvDAK73/WvDAK73/GvDAK73+2vDAK736msDAK736WsDAKFnq74CwLop4iNBQLzsOqmDwLW2cW7CQK546fNBAKcjIHmDgLnleP7CALKvv2MAgL91L3SCgLA/Z/nBAKFnqr4CwLop4SNBQLzsOamDwLW2cG7CQK546PNBAKEntr7CwKcjL3mDgLnlZ/7CALKvvmMAgL91LnSCgLA/ZvnBAKFnqb4CwLop4CNBQLzsOKmDwLW2f27CQK549/MBAKcjLnmDgLnlZv7CALKvvWMAgL91LXSCgLA/ZfnBAKFnqL4CwLop7yNBQLzsJ6mDwLW2fm7CQK549vMBAKcjLXmDgLnlZf7CALKvvGMAgL91LHSCgLA/ZPnBAKFnt77CwLop7iNBQLzsJqmDwL81K3SCgLW2fW7CQK549fMBAKcjLHmDgLnlZP7CALKvu2MAgL91K3SCgLA/Y/nBAKFntr7CwLop7SNBQLzsJamDwLW2fG7CQK549PMBAKcjK3mDgLnlY/7CALKvumMAgL91KnSCgLA/YvnBAKFntb7CwLop7CNBQLzsJKmDwLW2e27CQK548/MBAKcjKnmDgLnlYv7CALKvuWMAgL91KXSCgLA/YfnBAKFntL7CwLop6yNBQLzsI6mDwLW2em7CQK548vMBAKcjKXmDgLnlYf7CALKvuGMAgL91KHSCgLA/YPnBAKFno74CwLop+iNBQLzsMqmDwLW2aW4CQK544fNBAKcjOHmDgLJvu2MAgLH/Y/nBALnlcP7CALKvt2MAgL91J3SCgK449PMBALA/f/nBAKFnor4CwLop+SNBQLzsMamDwLW2aG4CQK544PNBAKcjJ3mDgLvp7SNBQLnlf/7CALKvtmMAgL91JnSCgLA/fvnBAKEnq74CwLvp4iNBQLysOqmDwLV2cW7CQK446fNBAKDjIHmDgLmleP7CALJvv2MAgL81L3SCgLH/Z/nBAKEnqr4CwLvp4SNBQLysOamDwLV2cG7CQK446PNBAKDjL3mDgLmlZ/7CALJvvmMAgL81LnSCgLH/ZvnBAKEnqb4CwLvp4CNBQLysOKmDwLV2f27CQK449/MBAKDjLnmDgLmlZv7CALJvvWMAgL81LXSCgLH/ZfnBAKEnqL4CwLvp7yNBQLysJ6mDwLV2fm7CQK449vMBAKDjLXmDgLmlZf7CALJvvGMAgL81LHSCgLH/ZPnBAKEnt77CwLvp7iNBQLysJqmDwLV2fW7CQK449fMBAKDjLHmDgL+t+7/CQKc2MCQBQLcqvDTBgLf0+G9AwK9vM/SDwL9zv+RDAKCyo2vAQLgpaPADQKg15ODDgLFmMHZCgKn9++2BgLnhd/1BQKbjawQAvnigv8MArmQsrwPArr989oIAriT2M4IArPRmdwBApjUhoYBAvvq5Y4PfeRqfz6SC/AE2nu5ROGN99vN3jQ=",
          "ctl00$ContentPlaceHolder1$wizardPageHeader$nav$sectionTabs$TabHeaders$ctl03$tabButton" => "Working Holiday Specific",
          "ctl00$ContentPlaceHolder1$character$imprisonment5YearsDropDownList"                    => "No",
          "ctl00$ContentPlaceHolder1$character$imprisonment12MonthsDropDownList"                  => "No",
          "ctl00$ContentPlaceHolder1$character$removalOrderDropDownList"                          => "No",
          "ctl00$ContentPlaceHolder1$character$deportedDropDownList"                              => "No",
          "ctl00_ContentPlaceHolder1_character_deportedDateDatePicker_Day"                        => "0",
          "ctl00_ContentPlaceHolder1_character_deportedDateDatePicker_Month"                      => "0",
          "ctl00_ContentPlaceHolder1_character_deportedDateDatePicker_Year"                       => "0",
          "ctl00$ContentPlaceHolder1$character$deportedDateDatePicker"                            => "",
          "ctl00_ContentPlaceHolder1_character_deportedDateDatePicker_MaxDate"                    => "24 May 2016",
          "ctl00_ContentPlaceHolder1_character_deportedDateDatePicker_MinDate"                    => "24 May 1985",
          "ctl00_ContentPlaceHolder1_character_deportedDateDatePicker_ControlState"               => "/wEXBQUMU2VsZWN0ZWREYXRlBgAAAAAAAAAABQxQcmV2aW91c0RhdGUGAAAAAAAAAAAFB01heERhdGUGAGA+xAGD04gFEFNlbGVjdGVkRGF0ZVRleHQFBTAtMC0wBQdNaW5EYXRlBgAg39BawbCI",
          "ctl00$ContentPlaceHolder1$character$countryDropDownList"                               => "",
          "ctl00$ContentPlaceHolder1$character$chargedDropDownList"                               => "No",
          "ctl00$ContentPlaceHolder1$character$convictedDropDownList"                             => "No",
          "ctl00$ContentPlaceHolder1$character$underInvestigationDropDownList"                    => "No",
          "ctl00$ContentPlaceHolder1$character$excludedDropDownList"                              => "No",
          "ctl00$ContentPlaceHolder1$character$removedDropDownList"                               => "No",
          "ctl00$ContentPlaceHolder1$character$excludeRemovedDetailsTextbox"                      => ""
        }.to_query
    end
  end

  def working_holiday_specific
    res = @conn.post do |req|
      req.url "/WorkingHoliday/Wizard/WorkingHolidaySpecific.aspx?ApplicationId=#{@data["application_id"]}&IndividualType=Primary&IndividualIndex=1"

      specific = @config["working_holiday_specific"]
      req.body = {
          "__VIEWSTATE"                                                                                             => "/wEPDwULLTIxMTU0MjM5NzgPFgIeEENvbmN1cnJlbmN5U3RhbXAFJDI5NDVmMDlmLTExNmQtNDBmOC05ZTRlLTVkYWNmZGYxZTUzNRYCZg9kFgICAw9kFgICAw9kFgYCAQ9kFgJmD2QWDAIFDw8WAh4HVmlzaWJsZWhkZAIJDw8WAh8BaGRkAgsPDxYCHwFoZGQCDw9kFgICAQ8QDxYCHgdDaGVja2VkaGRkZGQCEw9kFgYCAQ8PFgIfAWhkFgICAQ8QZGQWAGQCAw9kFgJmD2QWAmYPZBYCZg9kFgICAQ8WAh4LXyFJdGVtQ291bnQCBBYIZg9kFgQCAg8WBh4Dc3JjBSF+L0ltYWdlcy9UYWJjb250cm9sL2ljb25fdGljay5naWYeA2FsdAUJQ29tcGxldGVkHgV0aXRsZQUJQ29tcGxldGVkZAIEDw8WBB4PQ29tbWFuZEFyZ3VtZW50BWQvV29ya2luZ0hvbGlkYXkvV2l6YXJkL1BlcnNvbmFsMS5hc3B4P0FwcGxpY2F0aW9uSWQ9MTUwMDUxOCZJbmRpdmlkdWFsVHlwZT1QcmltYXJ5JkluZGl2aWR1YWxJbmRleD0xHgRUZXh0BQhQZXJzb25hbBYCHwYFEFBlcnNvbmFsIERldGFpbHNkAgEPZBYEAgIPFgYfBAUhfi9JbWFnZXMvVGFiY29udHJvbC9pY29uX3RpY2suZ2lmHwUFCUNvbXBsZXRlZB8GBQlDb21wbGV0ZWRkAgQPDxYEHwcFYy9Xb3JraW5nSG9saWRheS9XaXphcmQvTWVkaWNhbDEuYXNweD9BcHBsaWNhdGlvbklkPTE1MDA1MTgmSW5kaXZpZHVhbFR5cGU9UHJpbWFyeSZJbmRpdmlkdWFsSW5kZXg9MR8IBQZIZWFsdGgWAh8GBQ9NZWRpY2FsIERldGFpbHNkAgIPZBYEAgIPFgYfBAUhfi9JbWFnZXMvVGFiY29udHJvbC9pY29uX3RpY2suZ2lmHwUFCUNvbXBsZXRlZB8GBQlDb21wbGV0ZWRkAgQPDxYEHwcFZC9Xb3JraW5nSG9saWRheS9XaXphcmQvQ2hhcmFjdGVyLmFzcHg/QXBwbGljYXRpb25JZD0xNTAwNTE4JkluZGl2aWR1YWxUeXBlPVByaW1hcnkmSW5kaXZpZHVhbEluZGV4PTEfCAUJQ2hhcmFjdGVyFgIfBgUJQ2hhcmFjdGVyZAIDD2QWBgIBDxYCHwgFEzxkaXYgY2xhc3M9Y3VycmVudD5kAgIPFgYfBAUifi9JbWFnZXMvVGFiY29udHJvbC9pY29uX2Vycm9yLmdpZh8FBQ9Db250YWlucyBFcnJvcnMfBgUPQ29udGFpbnMgRXJyb3JzZAIEDw8WCB4IQ3NzQ2xhc3MFDm5ld3RhYmJ1dHRvbm9uHwcFcS9Xb3JraW5nSG9saWRheS9XaXphcmQvV29ya2luZ0hvbGlkYXlTcGVjaWZpYy5hc3B4P0FwcGxpY2F0aW9uSWQ9MTUwMDUxOCZJbmRpdmlkdWFsVHlwZT1QcmltYXJ5JkluZGl2aWR1YWxJbmRleD0xHwgFGFdvcmtpbmcgSG9saWRheSBTcGVjaWZpYx4EXyFTQgICFgIfBgU2UXVlc3Rpb25zIFNwZWNpZmljIHRvIHlvdXIgV29ya2luZyBIb2xpZGF5IGFwcGxpY2F0aW9uZAIFDw8WAh8BaGQWAgIBD2QWAmYPZBYCZg9kFgJmD2QWAgIBDxYCHwNmZAIVDxYIHgtjZWxsc3BhY2luZwUBMB4LY2VsbHBhZGRpbmcFATIeBmJvcmRlcgUBMB4FY2xhc3MFCXNpdGV0YWJsZRYCZg8WAh4GdmFsaWduBQN0b3BkAgMPFggfDAUBMh8LBQEwHw0FATAfDgUJc2l0ZXRhYmxlFgQCAQ8WBB8PBQN0b3AfAWhkAgIPFgIfDwUDdG9wFgICAQ9kFgRmDw8WAh8BaGQWBgIBD2QWBAIBDxBkZBYAZAIJDxBkZBYAZAIDD2QWAgIBDxBkZBYAZAIFD2QWBAIBDxBkZBYAZAIJDxBkZBYAZAICDw8WBh5GY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRvZmZzaG9yZURldGFpbHMkaW50ZW5kZWRUcmF2ZWxEYXRlRGF0ZVBpY2tlcmUePmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkb2Zmc2hvcmVEZXRhaWxzJGJlZW5Ub056RHJvcERvd25MaXN0ZR48Y3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRvZmZzaG9yZURldGFpbHMkd2hlbkluTlpEYXRlUGlja2VyZWQWFAIBDw8WBB5fY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRvZmZzaG9yZURldGFpbHMkY29tbW9uV0hTUXVlc3Rpb25zJHN1ZmZpY2llbnRGdW5kc0hvbGlkYXlEcm9wRG93bkxpc3RlHl5jdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJG9mZnNob3JlRGV0YWlscyRjb21tb25XSFNRdWVzdGlvbnMkcHJldmlvdXNXaHNQZXJtaXRWaXNhRHJvcERvd25MaXN0ZWQWDgIBDxAPFgYeDURhdGFUZXh0RmllbGQFBVZhbHVlHg5EYXRhVmFsdWVGaWVsZAUDS2V5HgtfIURhdGFCb3VuZGdkEBUDEFNlbGVjdCBhbiBvcHRpb24CTm8DWWVzFQMAAk5vA1llcxQrAwNnZ2dkZAIDDw8WBh8JBRFFcnJvck1lc3NhZ2VTbWFsbB4HVG9vbFRpcAUSRmllbGQgaXMgbWFuZGF0b3J5HwoCAmRkAgUPDxYCHwFoZGQCBw8WCB4EaHJlZgVNaHR0cDovL2Zvcm1zaGVscC5pbW1pZ3JhdGlvbi5nb3Z0Lm56L29ubGluZXNlcnZpY2VzL3doc29ubGluZS9zdWZmaWNpZW50ZnVuZHMeB29uY2xpY2sF1gF3aW5kb3cub3BlbignaHR0cDovL2Zvcm1zaGVscC5pbW1pZ3JhdGlvbi5nb3Z0Lm56L29ubGluZXNlcnZpY2VzL3doc29ubGluZS9zdWZmaWNpZW50ZnVuZHMnLCduZXdwb3B1cCcsJ3Rvb2xiYXI9bm8sbG9jYXRpb249bm8sc3RhdHVzPXllcyxtZW51YmFyPW5vLHNjcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsd2lkdGg9NjAwLGhlaWdodD00MzQnKTsgcmV0dXJuIGZhbHNlHglpbm5lcmh0bWwFBGhlcmUfBgUaTGluayBvcGVucyBpbiBhIG5ldyB3aW5kb3dkAgkPEA8WBh8VBQVWYWx1ZR8WBQNLZXkfF2dkEBUDEFNlbGVjdCBhbiBvcHRpb24CTm8DWWVzFQMAAk5vA1llcxQrAwNnZ2dkZAILDw8WBh8JBRFFcnJvck1lc3NhZ2VTbWFsbB8YBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICZGQCDQ8PFgIfAWhkZAIFDw8WBh8JBRFFcnJvck1lc3NhZ2VTbWFsbB8YBRJGaWVsZCBpcyBtYW5kYXRvcnkfCgICZGQCBw8PFgIfAWhkZAIJDw8WAh8BaGQWAgIBDxBkZBYAZAILDxAPFgYfFQUFVmFsdWUfFgUDS2V5HxdnZBAVAxBTZWxlY3QgYW4gb3B0aW9uAk5vA1llcxUDAAJObwNZZXMUKwMDZ2dnZGQCDQ8PFgYfCQURRXJyb3JNZXNzYWdlU21hbGwfGAUSRmllbGQgaXMgbWFuZGF0b3J5HwoCAmRkAg8PDxYCHwFoZGQCEw8PFggfCQURRXJyb3JNZXNzYWdlU21hbGwfGAUSRmllbGQgaXMgbWFuZGF0b3J5HwoCAh8BaGRkAhUPDxYCHwFoZGQCFw8PFgQeZ2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkb2Zmc2hvcmVEZXRhaWxzJHJlcXVpcmVtZW50c1F1ZXN0aW9ucyRzdWZmaWNpZW50RnVuZHNPbndhcmRUaWNrZXREcm9wRG93bkxpc3RlHlxjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJG9mZnNob3JlRGV0YWlscyRyZXF1aXJlbWVudHNRdWVzdGlvbnMkcmVhZFJlcXVpcmVtZW50c0Ryb3BEb3duTGlzdGVkFg4CAQ8QDxYGHxUFBVZhbHVlHxYFA0tleR8XZ2QQFQMQU2VsZWN0IGFuIG9wdGlvbgJObwNZZXMVAwACTm8DWWVzFCsDA2dnZ2RkAgMPDxYGHwkFEUVycm9yTWVzc2FnZVNtYWxsHxgFEkZpZWxkIGlzIG1hbmRhdG9yeR8KAgJkZAIFDw8WAh8BaGRkAgcPFggfGQVMaHR0cDovL2Zvcm1zaGVscC5pbW1pZ3JhdGlvbi5nb3Z0Lm56L29ubGluZXNlcnZpY2VzL3doc29ubGluZS9zcGVjaWFsY291bnRyeR8aBdUBd2luZG93Lm9wZW4oJ2h0dHA6Ly9mb3Jtc2hlbHAuaW1taWdyYXRpb24uZ292dC5uei9vbmxpbmVzZXJ2aWNlcy93aHNvbmxpbmUvc3BlY2lhbGNvdW50cnknLCduZXdwb3B1cCcsJ3Rvb2xiYXI9bm8sbG9jYXRpb249bm8sc3RhdHVzPXllcyxtZW51YmFyPW5vLHNjcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsd2lkdGg9NjAwLGhlaWdodD00MzQnKTsgcmV0dXJuIGZhbHNlHxsFG3NwZWNpZmljIA0KCQkJCXJlcXVpcmVtZW50cx8GBRpMaW5rIG9wZW5zIGluIGEgbmV3IHdpbmRvd2QCCQ8QDxYGHxUFBVZhbHVlHxYFA0tleR8XZ2QQFQMQU2VsZWN0IGFuIG9wdGlvbgJObwNZZXMVAwACTm8DWWVzFCsDA2dnZ2RkAgsPDxYGHwkFEUVycm9yTWVzc2FnZVNtYWxsHxgFEkZpZWxkIGlzIG1hbmRhdG9yeR8KAgJkZAINDw8WAh8BaGRkAgUPZBYCAgEPZBYMAgUPDxYCHwFoZGQCCQ8PFgIfAWhkZAILDw8WAh8BaGRkAg8PDxYCHwFoZBYCAgEPEA8WAh8CaGRkZGQCEw8PFgIfAWhkFgYCAQ9kFgICAQ8QZGQWAGQCAw9kFgJmD2QWAmYPZBYCZg9kFgICAQ8WAh8DZmQCBQ9kFgICAQ9kFgJmD2QWAmYPZBYCZg9kFgICAQ8WAh8DZmQCFQ8WCB8LBQEwHwwFATIfDQUBMB8OBQlzaXRldGFibGUWAmYPFgIfDwUDdG9wZBgBBR5fX0NvbnRyb2xzUmVxdWlyZVBvc3RCYWNrS2V5X18WCQVCY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSR3aXphcmRQYWdlSGVhZGVyJG5hdiRwcmV2aW91c0ltYWdlQnV0dG9uBT1jdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VIZWFkZXIkbmF2JHZhbGlkYXRlQnV0dG9uBUdjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VIZWFkZXIkbmF2JGNvbXBsZXRlTGF0ZXJJbWFnZUJ1dHRvbgU+Y3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSR3aXphcmRQYWdlSGVhZGVyJG5hdiRuZXh0SW1hZ2VCdXR0b24FYmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2l6YXJkUGFnZUhlYWRlciRuYXYkbWFuZGF0b3J5RmllbGRzJGRpc3BsYXlNYW5kYXRvcnlGaWVsZEVycm9yc0NoZWNrQm94BVJjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VGb290ZXIkd2l6YXJkUGFnZU5hdmlnYXRvciRwcmV2aW91c0ltYWdlQnV0dG9uBU1jdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VGb290ZXIkd2l6YXJkUGFnZU5hdmlnYXRvciR2YWxpZGF0ZUJ1dHRvbgVXY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSR3aXphcmRQYWdlRm9vdGVyJHdpemFyZFBhZ2VOYXZpZ2F0b3IkY29tcGxldGVMYXRlckltYWdlQnV0dG9uBU5jdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHdpemFyZFBhZ2VGb290ZXIkd2l6YXJkUGFnZU5hdmlnYXRvciRuZXh0SW1hZ2VCdXR0b24bPWMTqW2V1+IEmkRISr1UtdHNcA==",
          "__VIEWSTATEGENERATOR"                                                                                    => "9054C4F8",
          "__EVENTVALIDATION"                                                                                       => "/wEWHQKX3obqCALrrtPBCQKtj7PUDgLf1qWKDALp2rzdDwKR2+qeDwLOg/2ZDAL9gIvwAwKs18aVCAKz8qjzCwKQo4CLAwLyzK7kDwKyvp6nDALLkvu1BQKp/dXaCQLpj+WZCgLr9ZT6CAKJmrqVBALJ6IrWBwLFg+XDCwKn7MusBwLnnvvvBALFxp9oAqepsYcMAufbgcQPAriT2M4IArPRmdwBApjUhoYBAvvq5Y4PCkIkVv/05E560r0e6W+TBcUhYJw=",
          "ctl00$ContentPlaceHolder1$offshoreDetails$commonWHSQuestions$previousWhsPermitVisaDropDownList"          => "No",
          "ctl00$ContentPlaceHolder1$offshoreDetails$commonWHSQuestions$sufficientFundsHolidayDropDownList"         => "Yes",
          "ctl00_ContentPlaceHolder1_offshoreDetails_intendedTravelDateDatePicker_Day"                              => specific["travel_day"],
          "ctl00_ContentPlaceHolder1_offshoreDetails_intendedTravelDateDatePicker_Month"                            => specific["travel_month"],
          "ctl00_ContentPlaceHolder1_offshoreDetails_intendedTravelDateDatePicker_Year"                             => specific["travel_year"],
          "ctl00$ContentPlaceHolder1$offshoreDetails$intendedTravelDateDatePicker"                                  => "",
          "ctl00_ContentPlaceHolder1_offshoreDetails_intendedTravelDateDatePicker_MaxDate"                          => "24 May 2017",
          "ctl00_ContentPlaceHolder1_offshoreDetails_intendedTravelDateDatePicker_MinDate"                          => "24 May 2016",
          "ctl00_ContentPlaceHolder1_offshoreDetails_intendedTravelDateDatePicker_ControlState"                     => "/wEXBQUMU2VsZWN0ZWREYXRlBgAAAAAAAAAABQxQcmV2aW91c0RhdGUGAAAAAAAAAAAFB01heERhdGUGACAFPdOh1IgFEFNlbGVjdGVkRGF0ZVRleHQFBTAtMC0wBQdNaW5EYXRlBgBgPsQBg9OI",
          "ctl00$ContentPlaceHolder1$offshoreDetails$beenToNzDropDownList"                                          => specific["been_before"],
          "ctl00_ContentPlaceHolder1_offshoreDetails_whenInNZDatePicker_Day"                                        => specific["been_day"],
          "ctl00_ContentPlaceHolder1_offshoreDetails_whenInNZDatePicker_Month"                                      => specific["been_month"],
          "ctl00_ContentPlaceHolder1_offshoreDetails_whenInNZDatePicker_Year"                                       => specific["been_year"],
          "ctl00$ContentPlaceHolder1$offshoreDetails$whenInNZDatePicker"                                            => "",
          "ctl00_ContentPlaceHolder1_offshoreDetails_whenInNZDatePicker_MaxDate"                                    => "24 May 2016",
          "ctl00_ContentPlaceHolder1_offshoreDetails_whenInNZDatePicker_MinDate"                                    => "24 May 1985",
          "ctl00_ContentPlaceHolder1_offshoreDetails_whenInNZDatePicker_ControlState"                               => "/wEXBQUMU2VsZWN0ZWREYXRlBgAAAAAAAAAABQxQcmV2aW91c0RhdGUGAAAAAAAAAAAFB01heERhdGUGAGA+xAGD04gFEFNlbGVjdGVkRGF0ZVRleHQFBTAtMC0wBQdNaW5EYXRlBgAg39BawbCI",
          "ctl00$ContentPlaceHolder1$offshoreDetails$requirementsQuestions$sufficientFundsOnwardTicketDropDownList" => "Yes",
          "ctl00$ContentPlaceHolder1$offshoreDetails$requirementsQuestions$readRequirementsDropDownList"            => "Yes",
          "ctl00$ContentPlaceHolder1$wizardPageFooter$wizardPageNavigator$nextImageButton.x"                        => "30",
          "ctl00$ContentPlaceHolder1$wizardPageFooter$wizardPageNavigator$nextImageButton.y"                        => "6"
        }.to_query
    end
  end

  def submit
    res = @conn.post do |req|
      req.url "/WORKINGHOLIDAY/Application/Submit.aspx?ApplicationId=#{@data["application_id"]}"

      req.body = {
        "__VIEWSTATE"                                        => "/wEPDwUKMTU5Mjg5NDA1Mg9kFgJmD2QWAgIDD2QWAgIDD2QWBAIDD2QWCgIBDxYIHgRocmVmBURodHRwOi8vZ2xvc3NhcnkuaW1taWdyYXRpb24uZ292dC5uei9GYWxzZW9ybWlzbGVhZGluZ2luZm9ybWF0aW9uLmh0bR4Hb25jbGljawXNAXdpbmRvdy5vcGVuKCdodHRwOi8vZ2xvc3NhcnkuaW1taWdyYXRpb24uZ292dC5uei9GYWxzZW9ybWlzbGVhZGluZ2luZm9ybWF0aW9uLmh0bScsJ25ld3BvcHVwJywndG9vbGJhcj1ubyxsb2NhdGlvbj1ubyxzdGF0dXM9eWVzLG1lbnViYXI9bm8sc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx3aWR0aD02MDAsaGVpZ2h0PTQzNCcpOyByZXR1cm4gZmFsc2UeCWlubmVyaHRtbAUfZmFsc2Ugb3IgbWlzbGVhZGluZyBpbmZvcm1hdGlvbh4FdGl0bGUFGkxpbmsgb3BlbnMgaW4gYSBuZXcgd2luZG93ZAIDDxYIHwAFNWh0dHA6Ly9nbG9zc2FyeS5pbW1pZ3JhdGlvbi5nb3Z0Lm56L1Zpc2FhbmRQZXJtaXQuaHRtHwEFvgF3aW5kb3cub3BlbignaHR0cDovL2dsb3NzYXJ5LmltbWlncmF0aW9uLmdvdnQubnovVmlzYWFuZFBlcm1pdC5odG0nLCduZXdwb3B1cCcsJ3Rvb2xiYXI9bm8sbG9jYXRpb249bm8sc3RhdHVzPXllcyxtZW51YmFyPW5vLHNjcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsd2lkdGg9NjAwLGhlaWdodD00MzQnKTsgcmV0dXJuIGZhbHNlHwIFBHZpc2EfAwUaTGluayBvcGVucyBpbiBhIG5ldyB3aW5kb3dkAgsPFggfAAU1aHR0cDovL2dsb3NzYXJ5LmltbWlncmF0aW9uLmdvdnQubnovR29vZGNoYXJhY3Rlci5odG0fAQW+AXdpbmRvdy5vcGVuKCdodHRwOi8vZ2xvc3NhcnkuaW1taWdyYXRpb24uZ292dC5uei9Hb29kY2hhcmFjdGVyLmh0bScsJ25ld3BvcHVwJywndG9vbGJhcj1ubyxsb2NhdGlvbj1ubyxzdGF0dXM9eWVzLG1lbnViYXI9bm8sc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx3aWR0aD02MDAsaGVpZ2h0PTQzNCcpOyByZXR1cm4gZmFsc2UfAgUaZ29vZCANCgkJCQkJCQkJCQljaGFyYWN0ZXIfAwUaTGluayBvcGVucyBpbiBhIG5ldyB3aW5kb3dkAhUPFggfAAVAaHR0cDovL2dsb3NzYXJ5LmltbWlncmF0aW9uLmdvdnQubnovT2NjdXBhdGlvbmFscmVnaXN0cmF0aW9uLmh0bR8BBckBd2luZG93Lm9wZW4oJ2h0dHA6Ly9nbG9zc2FyeS5pbW1pZ3JhdGlvbi5nb3Z0Lm56L09jY3VwYXRpb25hbHJlZ2lzdHJhdGlvbi5odG0nLCduZXdwb3B1cCcsJ3Rvb2xiYXI9bm8sbG9jYXRpb249bm8sc3RhdHVzPXllcyxtZW51YmFyPW5vLHNjcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsd2lkdGg9NjAwLGhlaWdodD00MzQnKTsgcmV0dXJuIGZhbHNlHwIFDHJlZ2lzdHJhdGlvbh8DBRpMaW5rIG9wZW5zIGluIGEgbmV3IHdpbmRvd2QCIQ9kFgICAQ8WCB8ABRZodHRwOi8vd3d3LmlhYS5nb3Z0Lm56HwEFnwF3aW5kb3cub3BlbignaHR0cDovL3d3dy5pYWEuZ292dC5ueicsJ25ld3BvcHVwJywndG9vbGJhcj1ubyxsb2NhdGlvbj1ubyxzdGF0dXM9eWVzLG1lbnViYXI9bm8sc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx3aWR0aD02MDAsaGVpZ2h0PTQzNCcpOyByZXR1cm4gZmFsc2UfAgUPd3d3LmlhYS5nb3Z0Lm56HwMFGkxpbmsgb3BlbnMgaW4gYSBuZXcgd2luZG93ZAIFDw8WAh4HVmlzaWJsZWhkFgYCAQ8WAh8ABSx+L0FwcGxpY2F0aW9uL1BheS5hc3B4P0FwcGxpY2F0aW9uSWQ9MTUwMDUxOGQCAw8WAh8ABRwvV29ya2luZ0hvbGlkYXkvZGVmYXVsdC5hc3B4ZAIFDw8WAh8EaGRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYNBTBjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGZhbHNlU3RhdGVtZW50Q2hlY2tCb3gFJ2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkbm90ZXNDaGVja0JveAUvY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRjaXJjdW1zdGFuY2VzQ2hlY2tCb3gFKmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkd2FycmFudHNDaGVja0JveAUtY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRpbmZvcm1hdGlvbkNoZWNrQm94BShjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGhlYWx0aENoZWNrQm94BShjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGFkdmljZUNoZWNrQm94BS5jdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHJlZ2lzdHJhdGlvbkNoZWNrQm94BS1jdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGVudGl0bGVtZW50Q2hlY2tib3gFLmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkcGVybWl0RXhwaXJ5Q2hlY2tCb3gFMmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkbWVkaWNhbEluc3VyYW5jZUNoZWNrQm94BStjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHN1Ym1pdEltYWdlQnV0dG9uBStjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGNhbmNlbEltYWdlQnV0dG9ucICgPQrIobZ9AKtDlXG/MwTgZ58=",
        "__VIEWSTATEGENERATOR"                               => "8150357E",
        "__EVENTVALIDATION"                                  => "/wEWDgKZ88DhAwL/8dZuAsHWi8IEApjJsR0Ch6bl8QQC5d23hgoCs7+ZyQMCy+Cclw8Cus3jmQoCi+2C5Q0CoouYvAYCh9P1wggCwciK/QwC+ZeOBAiLfRhlFTU3WOGK1Pxs06h2Y7+O",
        "ctl00$ContentPlaceHolder1$falseStatementCheckBox"   => "on",
        "ctl00$ContentPlaceHolder1$notesCheckBox"            => "on",
        "ctl00$ContentPlaceHolder1$circumstancesCheckBox"    => "on",
        "ctl00$ContentPlaceHolder1$warrantsCheckBox"         => "on",
        "ctl00$ContentPlaceHolder1$informationCheckBox"      => "on",
        "ctl00$ContentPlaceHolder1$healthCheckBox"           => "on",
        "ctl00$ContentPlaceHolder1$adviceCheckBox"           => "on",
        "ctl00$ContentPlaceHolder1$registrationCheckBox"     => "on",
        "ctl00$ContentPlaceHolder1$entitlementCheckbox"      => "on",
        "ctl00$ContentPlaceHolder1$permitExpiryCheckBox"     => "on",
        "ctl00$ContentPlaceHolder1$medicalInsuranceCheckBox" => "on",
        "ctl00$ContentPlaceHolder1$submitImageButton.x"      => "39",
        "ctl00$ContentPlaceHolder1$submitImageButton.y"      => "4"
      }.to_query
    end

    is_success = 
    res.body.include?("Please note that you must pay the application fee before your place is secured.") || 
    res.body.include?("Internal error. The questionnaire cannot be submitted because either its current status or your security permissions preclude this action.")

    if !is_success
     @logger.info "Scheme unavailable"
    end

    is_success
  end

  def on_line_payment    
    res = @conn.post do |req|
      req.url "/PaymentGateway/OnLinePayment.aspx?SourceUrl=https://onlineservices.immigration.govt.nz/WorkingHoliday/Application/SubmitConfirmation.aspx?ApplicationId=#{@data["application_id"]}&ApplicationId=#{@data["application_id"]}&ProductId=2"

      full_name = (@config["personal1"]["family_name"] + @config["personal1"]["given_name"]).upcase
      req.body = {
        "__EVENTTARGET"                              => "",
        "__EVENTARGUMENT"                            => "",
        "__VIEWSTATE"                                => "/wEPDwULLTEyMDY4Njc4MDkPZBYCZg9kFgICAw9kFgICAw9kFgICBw8WCB4FY2xhc3MFCXNpdGV0YWJsZR4LY2VsbHNwYWNpbmcFATAeBmJvcmRlcgUBMB4LY2VsbHBhZGRpbmcFATIWAgIBDxYCHgZ2YWxpZ24FA3RvcBYCAgIPZBYCAgEPDxYCHglNYXhMZW5ndGgCZGRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBSdjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJG9rSW1hZ2VCdXR0b24FK2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkY2FuY2VsSW1hZ2VCdXR0b27cKn7Ve9p8wZAjvx+vD5veCXC0nw==",
        "__VIEWSTATEGENERATOR"                       => "64EC2CD5",
        "__EVENTVALIDATION"                          => "/wEWBAKbnrrRDQLsqKiNDgLAhozUDwL5l44EvLqaWXWqwKlxNHR20Ez1IFDyuaU=",
        "ctl00$ContentPlaceHolder1$payorNameTextBox" => full_name,
        "ctl00$ContentPlaceHolder1$okImageButton.x"  => "25",
        "ctl00$ContentPlaceHolder1$okImageButton.y"  => "5"
      }.to_query
    end

    @logger.info "Location: #{res.headers[:Location]}"
    res.headers[:Location]
  end

end
